Found a 50 line (211 tokens) duplication in the following files: 
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py
Starting at line 10 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_splitcontainer.py

from .conftest import build_cleanup_test
from .probe import get_probe
from .properties import (  # noqa: F401
    test_enable_noop,
    test_flex_widget_size,
    test_focus_noop,
)


@pytest.fixture
async def content1():
    return toga.Box(
        children=[toga.Label("Box 1 content", style=Pack(flex=1))],
        style=Pack(background_color=REBECCAPURPLE),
    )


@pytest.fixture
async def content2():
    return toga.Box(
        children=[toga.Label("Box 2 content", style=Pack(flex=1))],
        style=Pack(background_color=CORNFLOWERBLUE),
    )


@pytest.fixture
async def content3():
    return toga.Box(
        children=[toga.Label("Box 3 content", style=Pack(flex=1))],
        style=Pack(background_color=GOLDENROD),
    )


@pytest.fixture
async def content1_probe(content1):
    return get_probe(content1)


@pytest.fixture
async def content2_probe(content2):
    return get_probe(content2)


@pytest.fixture
async def content3_probe(content3):
    return get_probe(content3)


@pytest.fixture
async def on_select_handler():

=====================================================================
Found a 21 line (186 tokens) duplication in the following files: 
Starting at line 292 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[2][2])

    # Fully collapse the tree
    widget.collapse()
    await probe.redraw("All nodes have been collapsed")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Fully collapse when already fully collapsed
    widget.collapse()
    await probe.redraw("All nodes are still collapsed")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

=====================================================================
Found a 32 line (179 tokens) duplication in the following files: 
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 55 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 101 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py

        style=Pack(direction=ROW, alignment=TOP, width=300),
        children=[
            ExampleNode("space_filler", style=Pack(width=100, height=540)),
            ExampleNode(
                "container",
                style=Pack(direction=COLUMN, padding_top=110, padding_bottom=120),
                children=[
                    ExampleNode(
                        "widget_a",
                        style=Pack(height=30, padding_top=32, padding_bottom=34),
                    ),
                    ExampleNode(
                        "widget_b",
                        style=Pack(height=36, padding_top=38, padding_bottom=40),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (300, 540),
        (300, 540),
        {
            "origin": (0, 0),
            "content": (300, 540),
            "children": [
                {"origin": (0, 0), "content": (100, 540)},
                {
                    "origin": (100, 110),

=====================================================================
Found a 40 line (176 tokens) duplication in the following files: 
Starting at line 151 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 474 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                style=Pack(direction=ROW, flex=1),
                size=(100, 100),
                children=[
                    ExampleNode(  # Explicit size
                        "child 1",
                        style=Pack(width=20, height=20),
                    ),
                    ExampleNode(  # No size, Explicit intrinsic
                        "child 2",
                        style=Pack(),
                        size=(20, 20),
                    ),
                    ExampleNode(  # No size, explicit expanding intrinsic
                        "child 3",
                        style=Pack(),
                        size=(at_least(20), at_least(20)),
                    ),
                    ExampleNode(  # Flexible size, no intrinsic
                        "child 4",
                        style=Pack(flex=1),
                    ),
                    ExampleNode(  # Flexible size with explicit intrinsic
                        "child 5",
                        style=Pack(flex=1),
                        size=(20, 20),
                    ),
                    ExampleNode(  # Flexible size with explicit expanding intrinsic
                        "child 6",
                        style=Pack(flex=1),
                        size=(at_least(20), at_least(20)),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (200, 100),

=====================================================================
Found a 44 line (173 tokens) duplication in the following files: 
Starting at line 126 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_dialogs.py
Starting at line 166 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_dialogs.py

    actual = await app.dialog(dialog)

    # The directory where the file dialog is opened can't be 100% predicted
    # so we need to modify the check to only inspect the filename.
    if result is None:
        assert actual is None
    else:
        assert actual.name == result.name


@pytest.mark.parametrize(
    "initial_directory, file_types, multiple_select, result",
    [
        # Successful single select
        (TESTS_DIR, None, False, TESTS_DIR / "data.py"),
        # Cancelled single select
        (TESTS_DIR, None, False, None),
        # Successful single select with no initial directory
        (None, None, False, TESTS_DIR / "data.py"),
        # Successful single select with file types
        (TESTS_DIR, ["txt"], False, TESTS_DIR / "data.py"),
        # Successful multiple selection
        (
            TESTS_DIR,
            None,
            True,
            [TESTS_DIR / "conftest.py", TESTS_DIR / "data.py"],
        ),
        # Successful multiple selection of one item
        (TESTS_DIR, None, True, [TESTS_DIR / "data.py"]),
        # Cancelled multiple selection
        (TESTS_DIR, None, True, None),
        # Successful multiple selection with no initial directory
        (None, None, True, [TESTS_DIR / "conftest.py", TESTS_DIR / "data.py"]),
        # Successful multiple selection with file types
        (
            TESTS_DIR,
            ["txt", "doc"],
            True,
            [TESTS_DIR / "conftest.py", TESTS_DIR / "data.py"],
        ),
    ],
)
async def test_open_file_dialog(

=====================================================================
Found a 39 line (166 tokens) duplication in the following files: 
Starting at line 72 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 152 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 475 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                size=(200, 100),
                children=[
                    ExampleNode(  # Explicit size
                        "child 1",
                        style=Pack(width=20, height=20),
                    ),
                    ExampleNode(  # No size, Explicit intrinsic
                        "child 2",
                        style=Pack(),
                        size=(20, 20),
                    ),
                    ExampleNode(  # No size, explicit expanding intrinsic
                        "child 3",
                        style=Pack(),
                        size=(at_least(20), at_least(20)),
                    ),
                    ExampleNode(  # Flexible size, no intrinsic
                        "child 4",
                        style=Pack(flex=1),
                    ),
                    ExampleNode(  # Flexible size with explicit intrinsic
                        "child 5",
                        style=Pack(flex=1),
                        size=(20, 20),
                    ),
                    ExampleNode(  # Flexible size with explicit expanding intrinsic
                        "child 6",
                        style=Pack(flex=1),
                        size=(at_least(20), at_least(20)),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (300, 100),

=====================================================================
Found a 39 line (166 tokens) duplication in the following files: 
Starting at line 394 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 475 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                size=(100, 200),
                children=[
                    ExampleNode(  # Explicit size
                        "child 1",
                        style=Pack(width=20, height=20),
                    ),
                    ExampleNode(  # No size, Explicit intrinsic
                        "child 2",
                        style=Pack(),
                        size=(20, 20),
                    ),
                    ExampleNode(  # No size, explicit expanding intrinsic
                        "child 3",
                        style=Pack(),
                        size=(at_least(20), at_least(20)),
                    ),
                    ExampleNode(  # Flexible size, no intrinsic
                        "child 4",
                        style=Pack(flex=1),
                    ),
                    ExampleNode(  # Flexible size with explicit intrinsic
                        "child 5",
                        style=Pack(flex=1),
                        size=(20, 20),
                    ),
                    ExampleNode(  # Flexible size with explicit expanding intrinsic
                        "child 6",
                        style=Pack(flex=1),
                        size=(at_least(20), at_least(20)),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (100, 300),

=====================================================================
Found a 21 line (164 tokens) duplication in the following files: 
Starting at line 602 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 679 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Non-visible row has been removed")
    assert probe.child_count((0,)) == 6
    probe.assert_cell_content((0, 2), 0, "ANEW")
    probe.assert_cell_content((0, 4), 0, "A4")
    probe.assert_cell_content((0, 5), 0, "AX")

    # Insert a new root
    widget.data.insert(0, {"a": "A!", "b": "B!", "c": "C!"})
    await probe.redraw("New root row has been appended")

    assert probe.child_count() == 2
    assert probe.child_count((0,)) == 0
    probe.assert_cell_content((0,), 0, "A!")

    # Delete a root
    del widget.data[1]
    await probe.redraw("Old root row has been removed")

    assert probe.child_count() == 1
    assert probe.child_count((0,)) == 0
    probe.assert_cell_content((0,), 0, "A!")

=====================================================================
Found a 39 line (164 tokens) duplication in the following files: 
Starting at line 72 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 152 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 394 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                size=(200, 100),
                children=[
                    ExampleNode(  # Explicit size
                        "child 1",
                        style=Pack(width=20, height=20),
                    ),
                    ExampleNode(  # No size, Explicit intrinsic
                        "child 2",
                        style=Pack(),
                        size=(20, 20),
                    ),
                    ExampleNode(  # No size, explicit expanding intrinsic
                        "child 3",
                        style=Pack(),
                        size=(at_least(20), at_least(20)),
                    ),
                    ExampleNode(  # Flexible size, no intrinsic
                        "child 4",
                        style=Pack(flex=1),
                    ),
                    ExampleNode(  # Flexible size with explicit intrinsic
                        "child 5",
                        style=Pack(flex=1),
                        size=(20, 20),
                    ),
                    ExampleNode(  # Flexible size with explicit expanding intrinsic
                        "child 6",
                        style=Pack(flex=1),
                        size=(at_least(20), at_least(20)),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (300, 100),

=====================================================================
Found a 30 line (159 tokens) duplication in the following files: 
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 55 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 101 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py

        style=Pack(direction=COLUMN, alignment=LEFT, height=300),
        children=[
            ExampleNode("space_filler", style=Pack(width=540, height=100)),
            ExampleNode(
                "container",
                style=Pack(direction=ROW, padding_left=110, padding_right=120),
                children=[
                    ExampleNode(
                        "widget_a",
                        style=Pack(width=30, padding_left=32, padding_right=34),
                    ),
                    ExampleNode(
                        "widget_b",
                        style=Pack(width=36, padding_left=38, padding_right=40),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (540, 300),
        (640, 300),
        {
            "origin": (0, 0),
            "content": (640, 300),
            "children": [
                {"origin": (0, 0), "content": (540, 100)},

=====================================================================
Found a 25 line (154 tokens) duplication in the following files: 
Starting at line 489 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 525 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert len(fill) == 1

    # Draw instructions no longer have the second
    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        # Begin fill
        ("push context", {}),
        ("begin path", {}),
        (
            "line to",
            {
                "x": 25,
                "y": 25,
                "fill_color": rgb(0, 0, 0),
                "fill_rule": FillRule.NONZERO,
            },
        ),
        ("fill", {"color": rgb(0, 0, 0), "fill_rule": FillRule.NONZERO}),
        ("pop context", {}),
        # End fill
        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 40, "y": 50}),

=====================================================================
Found a 22 line (153 tokens) duplication in the following files: 
Starting at line 387 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 750 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    probe.assert_cell_content(0, 3, "E0")


async def test_column_changes(widget, probe):
    """Columns can be added and removed"""
    # Header is visible, and has the right titles
    assert probe.header_visible
    assert probe.header_titles == ["A", "B", "C"]
    # Columns should be roughly equal in width; there's a healthy allowance for
    # inter-column padding etc.
    assert probe.column_width(0) == pytest.approx(probe.width / 3, abs=25)
    assert probe.column_width(1) == pytest.approx(probe.width / 3, abs=25)
    assert probe.column_width(2) == pytest.approx(probe.width / 3, abs=25)

    await _column_change_test(widget, probe)

    assert probe.header_titles == ["A", "B", "D", "E"]
    # The specific behavior for resizing is undefined; however, the columns should add
    # up to near the full width (allowing for inter-column padding, etc), and no single
    # column should be tiny.
    total_width = sum(probe.column_width(i) for i in range(0, 4))
    assert total_width == pytest.approx(probe.width, abs=100)

=====================================================================
Found a 25 line (139 tokens) duplication in the following files: 
Starting at line 455 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 496 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 20, "y": 30}),
        # Begin fill
        ("push context", {}),
        ("begin path", {}),
        (
            "line to",
            {
                "x": 25,
                "y": 25,
                "fill_color": rgb(0, 0, 0),
                "fill_rule": FillRule.NONZERO,
            },
        ),
        ("fill", {"color": rgb(0, 0, 0), "fill_rule": FillRule.NONZERO}),
        ("pop context", {}),
        # End fill
        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 40, "y": 50}),
        ("pop context", {}),
        ("line to", {"x": 99, "y": 99}),
        ("pop context", {}),
    ]

    # Remove the second draw instruction
    context.remove(second)

=====================================================================
Found a 36 line (130 tokens) duplication in the following files: 
Starting at line 78 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py
Starting at line 146 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

@pytest.mark.parametrize(
    "value, expected",
    [
        (None, False),
        ("", False),
        ("true", True),
        ("false", True),  # Evaluated as a string, this value is true.
        (0, False),
        (1234, True),
    ],
)
def test_readonly(widget, value, expected):
    """The readonly status of the widget can be changed."""
    # Widget is initially not readonly by default.
    assert not widget.readonly

    # Set the readonly status
    widget.readonly = value
    assert widget.readonly == expected

    # Set the widget readonly
    widget.readonly = True
    assert widget.readonly

    # Set the readonly status again
    widget.readonly = value
    assert widget.readonly == expected


@pytest.mark.parametrize(
    "value, expected",
    [
        ("New Text", "New Text"),
        ("", ""),
        (None, ""),
        (12345, "12345"),

=====================================================================
Found a 32 line (129 tokens) duplication in the following files: 
Starting at line 253 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 290 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    cleanup = Mock()
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        yield 0.01  # A short sleep
        handler_call["slept"] = True
        yield  # A yield without a sleep
        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler, cleanup=cleanup)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
        "slept": True,
        "done": True,
    }

    # Cleanup method was invoked
    cleanup.assert_called_once_with(obj, 42)

=====================================================================
Found a 30 line (126 tokens) duplication in the following files: 
Starting at line 410 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 450 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    monkeypatch.setattr(sys, "argv", ["app-exe", str(example_file)])

    app = ExampleDocumentApp(
        "Test App",
        "org.beeware.document-app",
        document_types=[ExampleDocument, OtherDocument],
    )

    # Create a second document window
    app.documents.open(other_file)

    # There are 2 open documents
    assert len(app.documents) == 2
    assert len(app.windows) == 2

    # Close the first document window (in a running app loop)
    async def close_window(app):
        list(app.windows)[0].close()

    app.loop.run_until_complete(close_window(app))

    # One document window closed.
    assert len(app.documents) == 1
    assert len(app.windows) == 1

    # App hasn't exited
    assert_action_not_performed(app, "exit")

    # Close the first document window (in a running app loop)
    app.loop.run_until_complete(close_window(app))

=====================================================================
Found a 29 line (124 tokens) duplication in the following files: 
Starting at line 398 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    cleanup = Mock()
    handler_call = {}

    async def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        await asyncio.sleep(0.01)  # A short sleep
        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler, cleanup=cleanup)

    # Raw handler is the original coroutine
    assert wrapped._raw == handler

    # Invoke the handler
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
        "done": True,
    }

    # Cleanup method was invoked
    cleanup.assert_called_once_with(obj, 42)

=====================================================================
Found a 7 line (123 tokens) duplication in the following files: 
Starting at line 106 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 365 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

    window1 = toga.Window("Test Window 1", position=(150, 150), size=(200, 200))
    window2 = toga.Window("Test Window 2", position=(400, 150), size=(200, 200))
    window3 = toga.Window("Test Window 3", position=(300, 400), size=(200, 200))

    window1.content = toga.Box(style=Pack(background_color=REBECCAPURPLE))
    window2.content = toga.Box(style=Pack(background_color=CORNFLOWERBLUE))
    window3.content = toga.Box(style=Pack(background_color=FIREBRICK))

=====================================================================
Found a 28 line (121 tokens) duplication in the following files: 
Starting at line 97 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 61 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py

    window_content.window == window
    window_content.app == app

    assert window._impl.interface == window
    assert_action_performed(window, "create MainWindow")

    # This is a secondary main window; app menus have not been created, but
    # window menus and toolbars have been.
    assert_action_not_performed(window, "create App menus")
    assert_action_performed(window, "create Window menus")
    assert_action_performed(window, "create toolbar")

    assert window.id == "my-window"
    assert window.title == "My Window"
    assert window.position == toga.Position(10, 20)
    assert window.size == toga.Size(200, 300)
    assert not window.resizable
    assert window.closable
    assert not window.minimizable
    assert window.on_close._raw == on_close_handler

    # The window has an empty toolbar; but it's also a secondary MainWindow created
    # *after* the app has finished initializing; check it has a change handler
    assert len(window.toolbar) == 0
    assert window.toolbar.on_change is not None


def test_close_unmodified(app):

=====================================================================
Found a 22 line (120 tokens) duplication in the following files: 
Starting at line 22 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 143 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py

                style=Pack(direction=ROW, width=100, height=100),
                size=(at_least(50), at_least(50)),
                children=[
                    ExampleNode(
                        "child",
                        style=Pack(width=50, height=50),
                        size=(at_least(0), at_least(0)),
                    ),
                ],
            ),
            ExampleNode(
                "third",
                style=Pack(width=0, height=0),  # Explicitly 0 sized
                size=(at_least(0), at_least(0)),
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (200, 100),

=====================================================================
Found a 28 line (119 tokens) duplication in the following files: 
Starting at line 104 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 137 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

            ["third", 333],
        ],
        accessors=["val1", "val2"],
    )

    assert len(source) == 3

    assert source[0].val1 == "first"
    assert source[0].val2 == 111

    assert source[1].val1 == "second"
    assert source[1].val2 == 222

    listener = Mock()
    source.add_listener(listener)

    # Set element 1
    source[1] = ["new element", 999]

    # source is the same size, but has different data
    assert len(source) == 3
    assert source[1].val1 == "new element"
    assert source[1].val2 == 999

    listener.insert.assert_called_once_with(index=1, item=source[1])


def test_dict():

=====================================================================
Found a 28 line (117 tokens) duplication in the following files: 
Starting at line 229 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 275 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

        and window2_widget_probe.height > initial_window2_widget_size[1]
    )

    # Make window 1 full screen via the app, window 2 no longer full screen
    app.set_full_screen(window1)
    await window1_probe.wait_for_window(
        "First extra window is full screen",
        full_screen=True,
    )
    assert app.is_full_screen

    assert app_probe.is_full_screen(window1)
    assert app_probe.content_size(window1)[0] > 1000
    assert app_probe.content_size(window1)[1] > 700
    assert (
        window1_widget_probe.width > initial_window1_widget_size[0]
        and window1_widget_probe.height > initial_window1_widget_size[1]
    )

    assert not app_probe.is_full_screen(window2)
    assert app_probe.content_size(window2) == initial_content2_size
    assert (
        window2_widget_probe.width == initial_window2_widget_size[0]
        and window2_widget_probe.height == initial_window2_widget_size[1]
    )

    # Exit full screen
    app.exit_full_screen()

=====================================================================
Found a 20 line (112 tokens) duplication in the following files: 
Starting at line 744 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 803 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    child1 = ExampleLeafWidget(id="child1_id")
    child2 = ExampleLeafWidget(id="child2_id")
    child3 = ExampleLeafWidget(id="child3_id")
    widget.add(child1, child2, child3)

    window = toga.Window()
    window.content = widget
    # Clear the event log
    EventLog.reset()

    assert widget.children == [child1, child2, child3]
    for child in widget.children:
        assert child.parent == widget
        assert child.app == app
        assert child.window == window
        assert app.widgets[child.id] == child
        assert window.widgets[child.id] == child

    # Remove 2 children
    widget.remove(child1, child3)

=====================================================================
Found a 25 line (110 tokens) duplication in the following files: 
Starting at line 195 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 264 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py

@pytest.mark.parametrize(
    "value, expected",
    [
        # float; approximate because of float conversion
        (1.23, Decimal("1.23")),
        (1.23e4, Decimal("12300")),
        # Integer
        (123, Decimal("123")),
        # Integer (but a value that evaluates as false)
        (0, Decimal("0")),
        # Float and integer specified as string
        ("1.23", Decimal("1.23")),
        ("123", Decimal("123")),
        ("1.23e+4", Decimal("1.23e+4")),
        # Excessive precision is truncated to step value
        ("1.23456", Decimal("1.23")),
        # Decimal
        (Decimal("1.23"), Decimal("1.23")),
        # Empty string
        ("", None),
        # None
        (None, None),
    ],
)
def test_min(widget, value, expected):

=====================================================================
Found a 26 line (109 tokens) duplication in the following files: 
Starting at line 125 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_detailedlist.py
Starting at line 159 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py

    assert probe.scroll_position <= 0


async def test_select(widget, probe, source, on_select_handler):
    """Rows can be selected"""
    # Initial selection is empty
    assert widget.selection is None
    await probe.redraw("No row is selected")
    on_select_handler.assert_not_called()

    # A single row can be selected
    await probe.select_row(1)
    await probe.redraw("Second row is selected")
    assert widget.selection == source[1]

    # Winforms generates two events, first removing the old selection and then adding
    # the new one.
    on_select_handler.assert_called_with(widget)
    on_select_handler.reset_mock()

    # Trying to multi-select only does a single select
    await probe.select_row(2, add=True)
    await probe.redraw("Third row is selected")
    assert widget.selection == source[2]
    on_select_handler.assert_called_with(widget)
    on_select_handler.reset_mock()

=====================================================================
Found a 41 line (108 tokens) duplication in the following files: 
Starting at line 35 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py
Starting at line 8 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/conftest.py

@pytest.fixture
def on_resize_handler():
    return Mock()


@pytest.fixture
def on_press_handler():
    return Mock()


@pytest.fixture
def on_drag_handler():
    return Mock()


@pytest.fixture
def on_release_handler():
    return Mock()


@pytest.fixture
def on_activate_handler():
    return Mock()


@pytest.fixture
def on_alt_press_handler():
    return Mock()


@pytest.fixture
def on_alt_drag_handler():
    return Mock()


@pytest.fixture
def on_alt_release_handler():
    return Mock()


@pytest.fixture

=====================================================================
Found a 23 line (108 tokens) duplication in the following files: 
Starting at line 35 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 182 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                size=(at_least(0), at_least(0)),
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (200, 100),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),
                },
                {
                    "origin": (100, 0),
                    "content": (100, 100),
                    "children": [
                        {"origin": (100, 0), "content": (50, 50)},

=====================================================================
Found a 22 line (103 tokens) duplication in the following files: 
Starting at line 11 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_passwordinput.py
Starting at line 30 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

    assert_action_performed(widget, "create PasswordInput")

    assert not widget.readonly
    assert widget.placeholder == ""
    assert widget.value == ""
    assert widget._on_change._raw is None
    assert widget._on_confirm._raw is None
    assert widget._on_gain_focus._raw is None
    assert widget._on_lose_focus._raw is None
    assert widget.validators == []


def test_create_with_values():
    """A multiline text input can be created with initial values."""
    on_change = Mock()
    on_confirm = Mock()
    on_gain_focus = Mock()
    on_lose_focus = Mock()
    validator1 = Mock(return_value=None)
    validator2 = Mock(return_value=None)

    widget = toga.PasswordInput(

=====================================================================
Found a 18 line (102 tokens) duplication in the following files: 
Starting at line 151 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_group.py
Starting at line 192 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_group.py

    assert not group_d.is_child_of(group_a)

    assert not group_a.is_child_of(group_b)
    assert not group_b.is_child_of(group_c)
    assert not group_a.is_child_of(group_c)
    assert not group_b.is_child_of(group_d)
    assert not group_a.is_child_of(group_d)

    assert not group_b.is_parent_of(group_a)
    assert not group_c.is_parent_of(group_b)
    assert not group_c.is_parent_of(group_a)
    assert not group_d.is_parent_of(group_b)
    assert not group_d.is_parent_of(group_a)

    assert group_a.parent is None
    assert group_a.root == group_a

    assert group_b.parent is None

=====================================================================
Found a 17 line (101 tokens) duplication in the following files: 
Starting at line 74 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py
Starting at line 100 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py

        style=Pack(text_direction=RTL, direction=ROW, alignment=TOP),
        children=[
            ExampleNode("space_filler", style=Pack(width=30, height=100)),
            ExampleNode("widget", style=Pack(width=30, height=30)),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (60, 100),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {"origin": (610, 0), "content": (30, 100)},

=====================================================================
Found a 14 line (100 tokens) duplication in the following files: 
Starting at line 577 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 654 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Partial row has been appended to a non-expanded root")

    assert probe.child_count((0,)) == 7
    probe.assert_cell_content((0, 2), 0, "AY")
    probe.assert_cell_content((0, 5), 0, "A4")
    probe.assert_cell_content((0, 6), 0, "AX")

    # Missing value has been populated
    probe.assert_cell_content((0, 2), 1, "MISSING!")

    # Change content on the partial row
    widget.data[0][2].a = "ANEW"
    widget.data[0][2].b = "BNEW"
    await probe.redraw("Partial non-visible row has been updated")

=====================================================================
Found a 18 line (100 tokens) duplication in the following files: 
Starting at line 454 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 586 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 10, "y": 20}),
        ("line to", {"x": 20, "y": 30}),
        # Begin fill
        ("push context", {}),
        ("begin path", {}),
        (
            "line to",
            {
                "x": 25,
                "y": 25,
                "fill_color": rgb(0, 0, 0),
                "fill_rule": FillRule.NONZERO,
            },
        ),
        ("fill", {"color": rgb(0, 0, 0), "fill_rule": FillRule.NONZERO}),
        ("pop context", {}),
        # End fill
        ("line to", {"x": 30, "y": 40}),

=====================================================================
Found a 18 line (100 tokens) duplication in the following files: 
Starting at line 455 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 532 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 20, "y": 30}),
        # Begin fill
        ("push context", {}),
        ("begin path", {}),
        (
            "line to",
            {
                "x": 25,
                "y": 25,
                "fill_color": rgb(0, 0, 0),
                "fill_rule": FillRule.NONZERO,
            },
        ),
        ("fill", {"color": rgb(0, 0, 0), "fill_rule": FillRule.NONZERO}),
        ("pop context", {}),
        # End fill
        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 40, "y": 50}),

=====================================================================
Found a 17 line (99 tokens) duplication in the following files: 
Starting at line 126 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py
Starting at line 152 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py

        style=Pack(text_direction=RTL, direction=COLUMN, alignment=LEFT),
        children=[
            ExampleNode("space_filler", style=Pack(width=100, height=30)),
            ExampleNode("widget", style=Pack(width=30, height=30)),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (100, 60),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {"origin": (0, 0), "content": (100, 30)},

=====================================================================
Found a 17 line (99 tokens) duplication in the following files: 
Starting at line 12 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/test_applicator.py
Starting at line 17 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

class ExampleWidget(toga.Widget):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._impl = self.factory.Widget(self)
        self._children = []


# Create the simplest possible widget with a concrete implementation that cannot
# have children.
class ExampleLeafWidget(toga.Widget):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._impl = self.factory.Widget(self)


@pytest.fixture
def grandchild():

=====================================================================
Found a 24 line (99 tokens) duplication in the following files: 
Starting at line 121 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 150 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    cleanup = Mock()
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        return 42

    wrapped = wrapped_handler(obj, handler, cleanup=cleanup)

    # Raw handler is the original function
    assert wrapped._raw == handler

    # Invoke handler
    assert wrapped("arg1", "arg2", kwarg1=3, kwarg2=4) == 42

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
    }

    # Cleanup method was invoked
    cleanup.assert_called_once_with(obj, 42)

=====================================================================
Found a 23 line (98 tokens) duplication in the following files: 
Starting at line 21 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 343 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                style=Pack(direction=ROW, flex=1),
                children=[
                    ExampleNode(
                        "child",
                        style=Pack(width=50, height=50),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (50, 50),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (320, 480),

=====================================================================
Found a 21 line (95 tokens) duplication in the following files: 
Starting at line 599 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 633 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    example_doc.main_window._impl.dialog_responses["QuestionDialog"] = [True]
    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

    # The second document is the one we just loaded
    new_doc = doc_app.documents[-1]
    assert new_doc.path == other_file
    assert new_doc.main_window.doc == new_doc
    assert new_doc.main_window in doc_app.windows

    # New window is in the same position as the old one.
    assert new_doc.main_window.position == orig_position

    # The example doc has been saved
    assert not example_doc.modified

=====================================================================
Found a 21 line (93 tokens) duplication in the following files: 
Starting at line 256 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 303 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

    app.exit_full_screen()
    await window1_probe.wait_for_window(
        "No longer full screen",
        full_screen=True,
    )

    assert not app.is_full_screen

    assert not app_probe.is_full_screen(window1)
    assert app_probe.content_size(window1) == initial_content1_size
    assert (
        window1_widget_probe.width == initial_window1_widget_size[0]
        and window1_widget_probe.height == initial_window1_widget_size[1]
    )

    assert not app_probe.is_full_screen(window2)
    assert app_probe.content_size(window2) == initial_content2_size
    assert (
        window2_widget_probe.width == initial_window2_widget_size[0]
        and window2_widget_probe.height == initial_window2_widget_size[1]
    )

=====================================================================
Found a 17 line (93 tokens) duplication in the following files: 
Starting at line 569 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 600 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 634 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

    # The second document is the one we just loaded
    new_doc = doc_app.documents[-1]
    assert new_doc.path == other_file
    assert new_doc.main_window.doc == new_doc
    assert new_doc.main_window in doc_app.windows

    # New window is in the same position as the old one.
    assert new_doc.main_window.position == orig_position

=====================================================================
Found a 33 line (92 tokens) duplication in the following files: 
Starting at line 425 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 558 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    widget.insert(0, child)

    # Widget knows about the child and vice versa
    assert widget.children == [child]
    assert child.parent == widget

    # Child has inherited parent's app/window details
    assert child.app == app
    assert child.window == window

    # The impl's insert_child has been invoked
    assert_action_performed_with(widget, "insert child", child=child._impl)

    # The widget's layout has been refreshed
    assert_action_performed_with(widget, "refresh")

    # The window's content gets a refresh notification
    assert_action_performed_with(window.content, "refresh")

    # App's widget index has been updated
    assert dict(app.widgets) == {
        "widget_id": widget,
        "child_id": child,
    }

    # Window's widget index has been updated
    assert dict(window.widgets) == {
        "widget_id": widget,
        "child_id": child,
    }


def test_insert_position(app, widget):

=====================================================================
Found a 34 line (91 tokens) duplication in the following files: 
Starting at line 8 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 8 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

from toga.style.pack import Pack

from ..conftest import skip_on_platforms
from .conftest import build_cleanup_test
from .probe import get_probe
from .properties import (  # noqa: F401
    test_background_color,
    test_background_color_reset,
    test_enable_noop,
    test_flex_widget_size,
    test_focus_noop,
    test_font,
)


@pytest.fixture
def verify_font_sizes():
    # We can't verify font sizes inside the Table
    return False, False


@pytest.fixture
def on_select_handler():
    return Mock()


@pytest.fixture
def on_activate_handler():
    return Mock()


@pytest.fixture
def source():
    return ListSource(

=====================================================================
Found a 11 line (91 tokens) duplication in the following files: 
Starting at line 246 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 256 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Root Node 1 is still expanded")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expand a single child node
    widget.expand(source[1][2])
    await probe.redraw("Child Node 1:2 has been expanded")

=====================================================================
Found a 15 line (89 tokens) duplication in the following files: 
Starting at line 268 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 294 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 323 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert "Don't know how to open documents with extension .unknown" in stdout

    # An untitled document has been created
    assert len(app.documents) == 1
    assert isinstance(app.documents[0], ExampleDocument)
    assert app.documents[0].title == "Example Document: Untitled"

    # Document window has been created and shown
    assert len(app.windows) == 1
    assert list(app.windows)[0] == app.documents[0].main_window
    assert_action_performed(app.documents[0].main_window, "create MainWindow")
    assert_action_performed(app.documents[0].main_window, "show")


def test_create_with_missing_file(monkeypatch, capsys):

=====================================================================
Found a 23 line (88 tokens) duplication in the following files: 
Starting at line 196 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_dialogs.py
Starting at line 237 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_dialogs.py

    actual = await app.dialog(dialog)

    assert actual == result


@pytest.mark.parametrize(
    "initial_directory, multiple_select, result",
    [
        # Successful single select
        (TESTS_DIR, False, TESTS_DIR / "widgets"),
        # Cancelled single select
        (TESTS_DIR, False, None),
        # Successful single select with no initial directory
        (None, False, TESTS_DIR / "widgets"),
        # Successful multiple selection
        (TESTS_DIR, True, [TESTS_DIR, TESTS_DIR / "widgets"]),
        # Successful multiple selection with one item
        (TESTS_DIR, True, [TESTS_DIR / "widgets"]),
        # Cancelled multiple selection
        (TESTS_DIR, True, None),
    ],
)
async def test_select_folder_dialog(

=====================================================================
Found a 16 line (87 tokens) duplication in the following files: 
Starting at line 192 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 356 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        assert getattr(fill, attr) == value

    # x and y aren't part of the fill instruction
    x = properties.pop("x")
    y = properties.pop("y")

    # The first and last instructions can be ignored; they're the root canvas context
    assert widget._impl.draw_instructions[1:-1] == [
        ("push context", {}),
        ("begin path", {}),
    ] + ([("move to", {"x": x, "y": y})] if has_move else []) + [
        (
            "line to",
            {
                "x": 30,
                "y": 40,

=====================================================================
Found a 10 line (87 tokens) duplication in the following files: 
Starting at line 333 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 354 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py

@pytest.mark.parametrize(
    "min, max, provided, clipped",
    [
        (10, 20, 15, Decimal(15)),
        (10, 20, 25, Decimal(20)),
        (10, 20, 5, Decimal(10)),
        (10, 20, None, None),
        # Check min/max values of 0
        (0, 20, -15, Decimal(0)),
        (-10, 0, 25, Decimal(0)),

=====================================================================
Found a 9 line (86 tokens) duplication in the following files: 
Starting at line 123 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 271 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 297 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 326 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert len(app.documents) == 1
    assert isinstance(app.documents[0], ExampleDocument)
    assert app.documents[0].title == "Example Document: Untitled"

    # Document window has been created and shown
    assert len(app.windows) == 1
    assert list(app.windows)[0] == app.documents[0].main_window
    assert_action_performed(app.documents[0].main_window, "create MainWindow")
    assert_action_performed(app.documents[0].main_window, "show")

=====================================================================
Found a 17 line (86 tokens) duplication in the following files: 
Starting at line 496 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 532 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 587 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 10, "y": 20}),
        # Begin fill
        ("push context", {}),
        ("begin path", {}),
        (
            "line to",
            {
                "x": 25,
                "y": 25,
                "fill_color": rgb(0, 0, 0),
                "fill_rule": FillRule.NONZERO,
            },
        ),
        ("fill", {"color": rgb(0, 0, 0), "fill_rule": FillRule.NONZERO}),
        ("pop context", {}),
        # End fill
        ("line to", {"x": 30, "y": 40}),

=====================================================================
Found a 10 line (85 tokens) duplication in the following files: 
Starting at line 246 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 256 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 276 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Root Node 1 is still expanded")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expand a single child node
    widget.expand(source[1][2])

=====================================================================
Found a 13 line (84 tokens) duplication in the following files: 
Starting at line 590 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 667 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Partial non-visible row has been updated")

    assert probe.child_count((0,)) == 7
    probe.assert_cell_content((0, 2), 0, "ANEW")
    probe.assert_cell_content((0, 5), 0, "A4")
    probe.assert_cell_content((0, 6), 0, "AX")

    # Missing value has the default empty string
    probe.assert_cell_content((0, 2), 1, "BNEW")

    # Delete a row
    del widget.data[0][3]
    await probe.redraw("Non-visible row has been removed")

=====================================================================
Found a 20 line (82 tokens) duplication in the following files: 
Starting at line 174 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py
Starting at line 229 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py

            await probe.wait_for_tab("More option should be displayed")
            # When the "more" menu is visible, the current tab is None.
            assert widget.current_tab.index is None
        except AttributeError:
            pass

        # on_select has been not been invoked
        on_select_handler.assert_not_called()

        # Select the second last tab in the GUI
        probe.select_tab(6)
        await probe.wait_for_tab("Tab 7 should be selected")

        assert widget.current_tab.index == 6
        assert extra_probes[3].width > probe.width * 0.8
        assert extra_probes[3].height > probe.height * 0.8

        # on_select has been invoked
        on_select_handler.assert_called_once_with(widget)
        on_select_handler.reset_mock()

=====================================================================
Found a 10 line (82 tokens) duplication in the following files: 
Starting at line 236 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 246 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 256 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 276 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Root Node 1 has been expanded")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expand a single root node again
    widget.expand(source[1])

=====================================================================
Found a 20 line (80 tokens) duplication in the following files: 
Starting at line 20 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 11 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py

    read_error = None

    def create(self):
        self.main_window = toga.DocumentWindow(self)
        self._mock_read = Mock()
        self._mock_write = Mock()

    def read(self):
        if self.read_error:
            # If the object has a "read_error" attribute, raise that exception
            raise self.read_error
        else:
            # We don't actually care about the file or it's contents, but it needs to exist;
            # so we open it to verify that behavior.
            with self.path.open():
                self._mock_read(self.path)

    def write(self):
        # We don't actually care about the file or it's contents.
        self._mock_write(self.path)

=====================================================================
Found a 16 line (80 tokens) duplication in the following files: 
Starting at line 25 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 71 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 117 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 150 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py

            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (300, 540),
        (300, 540),
        {
            "origin": (0, 0),
            "content": (300, 540),
            "children": [
                {"origin": (0, 0), "content": (100, 540)},
                {
                    "origin": (100, 110),

=====================================================================
Found a 13 line (79 tokens) duplication in the following files: 
Starting at line 50 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/src/testbed/app.py
Starting at line 39 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/conftest.py

    def startup(self):
        # Ensure that Toga's task factory is tracking all tasks
        toga_task_factory = self.loop.get_task_factory()

        def task_factory(loop, coro, context=None):
            if sys.version_info < (3, 11):
                task = toga_task_factory(loop, coro)
            else:
                task = toga_task_factory(loop, coro, context=context)
            assert task in self._running_tasks, f"missing task reference for {task}"
            return task

        self.loop.set_task_factory(task_factory)

=====================================================================
Found a 17 line (79 tokens) duplication in the following files: 
Starting at line 66 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 118 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    return toga.Table(
        data=source,
        missing_value="MISSING!",
        accessors=["a", "b", "c"],
        on_select=on_select_handler,
        style=Pack(flex=1),
    )


@pytest.fixture
async def headerless_probe(main_window, headerless_widget):
    old_content = main_window.content

    box = toga.Box(children=[headerless_widget])
    main_window.content = box
    probe = get_probe(headerless_widget)
    await probe.redraw("Constructing headerless Table probe")

=====================================================================
Found a 10 line (79 tokens) duplication in the following files: 
Starting at line 226 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 307 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expanding/collapsing nodes when tree is not expanded
    # Expand a single root node
    widget.expand(source[1])

=====================================================================
Found a 16 line (79 tokens) duplication in the following files: 
Starting at line 160 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 214 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py

    if change_handler:
        statusiconset.commands.on_change = change_handler

    status_1 = SimpleStatusIcon(id="s1")
    status_2 = SimpleStatusIcon(id="s2")
    status_3 = SimpleStatusIcon(id="s3")
    statusiconset.add(status_1, status_2, status_3)

    assert list(statusiconset) == [status_1, status_2, status_3]
    assert len(statusiconset) == 3

    EventLog.reset()
    if change_handler:
        change_handler.reset_mock()

    statusiconset.remove(status_2)

=====================================================================
Found a 8 line (79 tokens) duplication in the following files: 
Starting at line 565 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 581 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 20, "y": 30}),
        ("line to", {"x": 40, "y": 50}),

=====================================================================
Found a 10 line (78 tokens) duplication in the following files: 
Starting at line 266 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 286 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Child Node 1:2 is still expanded")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Attempt to collapse a leaf node
    widget.collapse(source[1][2][1])

=====================================================================
Found a 10 line (78 tokens) duplication in the following files: 
Starting at line 296 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 306 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 436 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("All nodes have been collapsed")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Fully collapse when already fully collapsed
    widget.collapse()

=====================================================================
Found a 24 line (78 tokens) duplication in the following files: 
Starting at line 342 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 378 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

        if id == toga.Command.NEW:
            return None
        return orig_standard(app, id)

    # Monkeypatch the backend to *not* create the new command
    monkeypatch.setattr(DummyCommand, "standard", mock_standard)

    # Mock the command line to open a file.
    monkeypatch.setattr(sys, "argv", ["app-exe", str(example_file)])

    app = ExampleDocumentApp(
        "Test App",
        "org.beeware.document-app",
        document_types=[ExampleDocument],
    )

    # Menus and commands have been created
    assert_action_performed(app, "create App commands")
    assert_action_performed(app, "create App menus")

    # 6 menu items have been created (About and Exit). File management
    # commands exist, *except* for NEW
    assert app._impl.n_menu_items == 6
    assert toga.Command.NEW not in app.commands

=====================================================================
Found a 16 line (78 tokens) duplication in the following files: 
Starting at line 71 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 150 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py

            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (540, 300),
        (640, 300),
        {
            "origin": (0, 0),
            "content": (640, 300),
            "children": [
                {"origin": (50, 0), "content": (540, 100)},
                {
                    "origin": (210, 100),

=====================================================================
Found a 17 line (77 tokens) duplication in the following files: 
Starting at line 92 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 145 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    return toga.Table(
        ["A", "B", "C"],
        data=source,
        multiple_select=True,
        on_select=on_select_handler,
        style=Pack(flex=1),
    )


@pytest.fixture
async def multiselect_probe(main_window, multiselect_widget):
    old_content = main_window.content

    box = toga.Box(children=[multiselect_widget])
    main_window.content = box
    probe = get_probe(multiselect_widget)
    await probe.redraw("Constructing multiselect Table probe")

=====================================================================
Found a 10 line (77 tokens) duplication in the following files: 
Starting at line 226 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 297 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 437 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expanding/collapsing nodes when tree is not expanded
    # Expand a single root node
    widget.expand(source[1])

=====================================================================
Found a 10 line (77 tokens) duplication in the following files: 
Starting at line 376 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 386 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Root Node 1 has been expanded")
    assert probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])  # Restores previous expansion state
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Expand a single root node again
    widget.expand(source[1])

=====================================================================
Found a 17 line (77 tokens) duplication in the following files: 
Starting at line 140 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 221 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

    root = ExampleNode(
        "app",
        style=Pack(direction=ROW),
        children=[
            ExampleNode(
                "first",
                style=Pack(flex=1),
                size=(100, 100),
            ),
            ExampleNode(
                "second",
                style=Pack(direction=ROW, flex=1),
                size=(100, 100),
                children=[
                    ExampleNode(  # Explicit size
                        "child 1",
                        style=Pack(width=20, height=20),

=====================================================================
Found a 17 line (77 tokens) duplication in the following files: 
Starting at line 463 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 545 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

    root = ExampleNode(
        "app",
        style=Pack(direction=COLUMN),
        children=[
            ExampleNode(
                "first",
                style=Pack(flex=1),
                size=(100, 100),
            ),
            ExampleNode(
                "second",
                style=Pack(direction=COLUMN, flex=1),
                size=(100, 100),
                children=[
                    ExampleNode(  # Explicit size
                        "child 1",
                        style=Pack(width=20, height=20),

=====================================================================
Found a 10 line (76 tokens) duplication in the following files: 
Starting at line 236 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 246 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 256 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 266 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 276 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 286 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Root Node 1 has been expanded")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expand a single root node again
    widget.expand(source[1])

=====================================================================
Found a 7 line (76 tokens) duplication in the following files: 
Starting at line 296 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 436 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 446 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("All nodes have been collapsed")
    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

=====================================================================
Found a 10 line (76 tokens) duplication in the following files: 
Starting at line 326 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 406 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 416 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("All nodes are still expanded")
    assert probe.is_expanded(source[0])
    assert probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse a single root node
    widget.collapse(source[1])

=====================================================================
Found a 15 line (76 tokens) duplication in the following files: 
Starting at line 40 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 84 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    cs = CommandSet(on_change=change_handler)
    cmd1a = toga.Command(None, text="Test command 1a", order=3)
    cmd1b = toga.Command(None, text="Test command 1b", order=1)
    cs.add(cmd1a, cmd1b)

    # Change handler was called once.
    if change_handler:
        change_handler.assert_called_once()
        change_handler.reset_mock()

    # Command set has commands, and the order is the opposite to the insertion order.
    assert list(cs) == [cmd1b, cmd1a]

    # New Commands aren't known to the app
    assert list(app.commands) == [cmd_a, cmd_b]

=====================================================================
Found a 11 line (76 tokens) duplication in the following files: 
Starting at line 151 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py
Starting at line 217 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

                    [
                        ({"val1": "child00", "val2": 11}, None),
                        ({"val1": "child01", "val2": 12}, []),
                        (
                            {"val1": "child02", "val2": 13},
                            [
                                ({"val1": "child020", "val2": 131}, None),
                                ({"val1": "child021", "val2": 132}, None),
                            ],
                        ),
                    ],

=====================================================================
Found a 11 line (76 tokens) duplication in the following files: 
Starting at line 165 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py
Starting at line 228 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

                    [
                        ({"val1": "child10", "val2": 21}, None),
                        ({"val1": "child11", "val2": 22}, []),
                        (
                            {"val1": "child12", "val2": 23},
                            [
                                ({"val1": "child120", "val2": 231}, None),
                                ({"val1": "child121", "val2": 232}, None),
                            ],
                        ),
                    ],

=====================================================================
Found a 17 line (76 tokens) duplication in the following files: 
Starting at line 262 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 299 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 405 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 439 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler, cleanup=cleanup)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},

=====================================================================
Found a 11 line (76 tokens) duplication in the following files: 
Starting at line 320 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_canvas.py
Starting at line 415 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("reset transform", {}),
        # ClosedPath
        ("push context", {}),
        ("begin path", {}),
        ("move to", {"x": 10, "y": 20}),
        ("line to", {"x": 20, "y": 30}),
        ("line to", {"x": 30, "y": 20}),
        ("close path", {}),
        ("pop context", {}),
        # Fill
        ("push context", {}),

=====================================================================
Found a 12 line (76 tokens) duplication in the following files: 
Starting at line 546 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 569 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("pop context", {}),
        # End fill
        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 20, "y": 30}),
        ("line to", {"x": 40, "y": 50}),
        ("pop context", {}),
        ("line to", {"x": 99, "y": 99}),
        ("pop context", {}),
    ]

    # Remove the fill context
    context.remove(fill)

=====================================================================
Found a 17 line (76 tokens) duplication in the following files: 
Starting at line 43 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_passwordinput.py
Starting at line 62 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

    assert_action_performed(widget, "create PasswordInput")

    assert widget.readonly
    assert widget.placeholder == "A placeholder"
    assert widget.value == "Some text"
    assert widget._on_change._raw == on_change
    assert widget._on_confirm._raw == on_confirm
    assert widget._on_gain_focus._raw == on_gain_focus
    assert widget._on_lose_focus._raw == on_lose_focus
    assert widget.validators == [validator1, validator2]

    # Validators have been invoked with the initial text
    validator1.assert_called_once_with("Some text")
    validator2.assert_called_once_with("Some text")

    # Change handler hasn't been invoked
    on_change.assert_not_called()

=====================================================================
Found a 6 line (75 tokens) duplication in the following files: 
Starting at line 226 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 447 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

=====================================================================
Found a 9 line (75 tokens) duplication in the following files: 
Starting at line 388 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 398 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Expand a single child node
    widget.expand(source[0][2])
    await probe.redraw("Child Node 0:2 has been expanded")

=====================================================================
Found a 14 line (75 tokens) duplication in the following files: 
Starting at line 442 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 520 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    widget.context.line_to(99, 99)

    # Counts are as expected
    assert len(widget.context) == 3
    assert len(context) == 5
    assert len(fill) == 1

    # Initial draw instructions are as expected
    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        ("line to", {"x": 20, "y": 30}),

=====================================================================
Found a 17 line (75 tokens) duplication in the following files: 
Starting at line 491 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py
Starting at line 530 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py

    assert len(optioncontainer.content) == 3
    assert_action_performed_with(optioncontainer, "remove option", index=1)

    # There's no item with the deleted label
    with pytest.raises(ValueError, match=r"No tab named 'Item 2'"):
        optioncontainer.content.index("Item 2")

    # The index of item 3 has been reduced; item 1 is untouched
    assert item1.index == 0
    assert item3.index == 1

    # Widget has been refreshed
    assert_action_performed(optioncontainer, "refresh")


@pytest.mark.parametrize("index", [0, "Item 1", None])
def test_delitem_current(optioncontainer, index):

=====================================================================
Found a 10 line (74 tokens) duplication in the following files: 
Starting at line 316 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 396 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("All nodes have been expanded")
    assert probe.is_expanded(source[0])
    assert probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Fully expand when already fully expanded
    widget.expand()

=====================================================================
Found a 10 line (74 tokens) duplication in the following files: 
Starting at line 326 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 406 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 426 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("All nodes are still expanded")
    assert probe.is_expanded(source[0])
    assert probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse a single root node
    widget.collapse(source[1])

=====================================================================
Found a 12 line (74 tokens) duplication in the following files: 
Starting at line 168 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py
Starting at line 202 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py

        -1.5 * pi,
        [
            (1.0, 0.0),
            (1.0, -0.5522847),
            (0.5522847, -1.0),
            (0.0, -1.0),
            (-0.5522847, -1.0),
            (-1.0, -0.5522847),
            (-1.0, 0.0),
            (-1.0, 0.5522847),
            (-0.5522847, 1.0),
            (0.0, 1.0),

=====================================================================
Found a 27 line (74 tokens) duplication in the following files: 
Starting at line 270 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 507 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    assert_action_performed_with(widget, "add child", child=child3._impl)

    # The widget's layout has been refreshed
    # There will be multiple refresh calls
    assert_action_performed_with(widget, "refresh")

    # The window's content gets a refresh notification
    assert_action_performed_with(window.content, "refresh")

    # App's widget index has been updated
    assert dict(app.widgets) == {
        "widget_id": widget,
        "child1_id": child1,
        "child2_id": child2,
        "child3_id": child3,
    }

    # Window's widget index has been updated
    assert dict(window.widgets) == {
        "widget_id": widget,
        "child1_id": child1,
        "child2_id": child2,
        "child3_id": child3,
    }


def test_reparent_child(widget):

=====================================================================
Found a 16 line (73 tokens) duplication in the following files: 
Starting at line 156 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 505 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                size=(at_least(0), at_least(0)),
            ),
        ],
    )

    # Normal size
    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (100, 200),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {"origin": (0, 0), "content": (100, 100)},

=====================================================================
Found a 6 line (73 tokens) duplication in the following files: 
Starting at line 122 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 202 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                    "content": (200, 100),
                    "children": [
                        {"origin": (100, 0), "content": (20, 20)},
                        {"origin": (120, 0), "content": (20, 20)},
                        {"origin": (140, 0), "content": (20, 100)},
                        {"origin": (160, 0), "content": (60, 100)},

=====================================================================
Found a 6 line (73 tokens) duplication in the following files: 
Starting at line 444 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 525 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                    "content": (100, 200),
                    "children": [
                        {"origin": (0, 100), "content": (20, 20)},
                        {"origin": (0, 120), "content": (20, 20)},
                        {"origin": (0, 140), "content": (100, 20)},
                        {"origin": (0, 160), "content": (100, 60)},

=====================================================================
Found a 19 line (73 tokens) duplication in the following files: 
Starting at line 228 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 460 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    window = toga.Window()
    window.content = widget
    # Clear the event log
    EventLog.reset()

    # Widget has an app and window
    assert widget.app == app
    assert widget.window == window

    # Child list is empty
    assert widget.children == []

    # Create 3 child widgets
    child1 = ExampleLeafWidget(id="child1_id")
    child2 = ExampleLeafWidget(id="child2_id")
    child3 = ExampleLeafWidget(id="child3_id")

    # App's widget index only contains the parent
    assert dict(app.widgets) == {"widget_id": widget}

=====================================================================
Found a 15 line (72 tokens) duplication in the following files: 
Starting at line 90 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_dialogs.py
Starting at line 129 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_dialogs.py

    actual = await app.dialog(dialog)

    assert actual == result


@pytest.mark.parametrize(
    "filename, file_types, result",
    [
        ("/path/to/file.txt", None, Path("/path/to/file.txt")),
        ("/path/to/file.txt", None, None),
        ("/path/to/file.txt", ["txt", "doc"], Path("/path/to/file.txt")),
        ("/path/to/file.txt", ["txt", "doc"], None),
    ],
)
async def test_save_file_dialog(

=====================================================================
Found a 8 line (72 tokens) duplication in the following files: 
Starting at line 49 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 63 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(container_probe.width, abs=2)
    assert probe.height == pytest.approx(container_probe.height, abs=2)
    assert probe.preserve_aspect_ratio
    probe.assert_image_size(
        pytest.approx(probe.width, abs=2),
        pytest.approx(probe.width // 2, abs=2),
    )

=====================================================================
Found a 10 line (72 tokens) duplication in the following files: 
Starting at line 316 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 326 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 396 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 406 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 416 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 426 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("All nodes have been expanded")
    assert probe.is_expanded(source[0])
    assert probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Fully expand when already fully expanded
    widget.expand()

=====================================================================
Found a 11 line (72 tokens) duplication in the following files: 
Starting at line 286 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 332 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    cs = CommandSet(on_change=change_handler)

    # Define some commands
    cmd_a = toga.Command(None, text="App command a", id="custom-command-a")
    cmd_b = toga.Command(None, text="App command b", id="custom-command-b")
    cs.add(cmd_a, cmd_b)
    if change_handler:
        change_handler.reset_mock()

    # Define a third command that isn't added.
    cmd_c = toga.Command(None, text="App command c", id="custom-command-c")

=====================================================================
Found a 19 line (72 tokens) duplication in the following files: 
Starting at line 316 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 392 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py

    new_child = leaf_node.insert(0, {"val1": "new"})

    # Leaf node isn't a leaf any more
    assert leaf_node.can_have_children()
    assert len(leaf_node) == 1
    assert leaf_node[0] == new_child

    # A child node was created using the source's factory
    source._create_node.assert_called_with(
        parent=leaf_node, data={"val1": "new"}, children=None
    )

    # insert notification was sent, the change is associated with the new item
    source.notify.assert_called_once_with(
        "insert", parent=leaf_node, index=0, item=leaf_node[0]
    )


def test_append(source, node):

=====================================================================
Found a 21 line (72 tokens) duplication in the following files: 
Starting at line 83 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 202 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py

                style=Pack(direction=ROW),
                children=[
                    ExampleNode(
                        "child",
                        style=Pack(),
                        size=(50, 50),
                    ),
                ],
            ),
            ExampleNode(  # Explicitly 0 sized
                "third",
                style=Pack(),
                size=(0, 0),
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (150, 100),

=====================================================================
Found a 17 line (72 tokens) duplication in the following files: 
Starting at line 193 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 339 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler, and run until it is complete.
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},

=====================================================================
Found a 21 line (72 tokens) duplication in the following files: 
Starting at line 224 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 369 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

        raise Exception("Problem in handler")

    wrapped = wrapped_handler(obj, handler)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler; return value is None due to exception
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4))
        is None
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
    }

    # Evidence of the handler cleanup error is in the log.
    assert (

=====================================================================
Found a 20 line (72 tokens) duplication in the following files: 
Starting at line 548 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_validators.py
Starting at line 613 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_validators.py

    validator = validators.ContainsSpecial(**kwargs)

    assert validator(value) == error


@pytest.mark.parametrize(
    "value, kwargs, error",
    [
        # Zero
        ("0", dict(), None),
        # positive integer
        ("123", dict(), None),
        # Negative integer
        ("-123", dict(), None),
        # Extra space
        (" 123 ", dict(), None),
        # leading zeros
        ("01234", dict(), None),
        # Allow empty strings
        ("", dict(), None),

=====================================================================
Found a 12 line (72 tokens) duplication in the following files: 
Starting at line 153 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py
Starting at line 184 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py

        1.5 * pi,
        [
            (1.0, 0.0),
            (1.0, 0.5522847),
            (0.5522847, 1.0),
            (0.0, 1.0),
            (-0.5522847, 1.0),
            (-1.0, 0.5522847),
            (-1.0, 0.0),
            (-1.0, -0.5522847),
            (-0.5522847, -1.0),
            (0.0, -1.0),

=====================================================================
Found a 28 line (72 tokens) duplication in the following files: 
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py
Starting at line 5 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py

    assert_action_not_performed,
    assert_action_performed,
    assert_action_performed_with,
)


@pytest.fixture
def window():
    return toga.Window()


@pytest.fixture
def content1():
    return toga.Box()


@pytest.fixture
def content2():
    return toga.Box()


@pytest.fixture
def content3():
    return toga.Box()


@pytest.fixture
def content4():

=====================================================================
Found a 18 line (71 tokens) duplication in the following files: 
Starting at line 71 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 104 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 137 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

            ("third", 333),
        ],
        accessors=["val1", "val2"],
    )

    assert len(source) == 3

    assert source[0].val1 == "first"
    assert source[0].val2 == 111

    assert source[1].val1 == "second"
    assert source[1].val2 == 222

    listener = Mock()
    source.add_listener(listener)

    # Set element 1
    source[1] = ("new element", 999)

=====================================================================
Found a 14 line (70 tokens) duplication in the following files: 
Starting at line 721 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 739 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [None]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # No second window was opened
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

    # The replace attribute has been removed.
    assert not hasattr(doc_app.documents[0].main_window, "_replace")


def test_open_menu_cancel_no_replace(monkeypatch, doc_app):

=====================================================================
Found a 12 line (68 tokens) duplication in the following files: 
Starting at line 31 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 54 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py

    await probe.redraw("Widget should be visible")

    # Widgets are all visible an in place
    assert not probe.is_hidden
    assert not child_probe.is_hidden
    assert not grandchild_probe.is_hidden
    probe.assert_layout(position=(0, 0), size=(100, 200))
    other_probe.assert_layout(position=(100, 0), size=(100, 200))

    # Hide the widget
    widget.style.visibility = HIDDEN
    await probe.redraw("Widget should be hidden")

=====================================================================
Found a 13 line (67 tokens) duplication in the following files: 
Starting at line 109 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 162 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py

    document_path = Path(__file__).parent / "docs/example.testbed"
    app.documents.open(document_path)

    await app_probe.redraw("Document has been opened", delay=0.1)

    assert len(app.documents) == 1
    assert len(app.windows) == 2

    # Document has been read.
    app.documents[0]._content.read.assert_called_with(document_path)

    # Save the document
    await app.documents.save()

=====================================================================
Found a 19 line (67 tokens) duplication in the following files: 
Starting at line 386 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 458 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py

            {"x": 10, "y": 20, "radiusx": 30, "radiusy": 40},
            (
                "x=10, y=20, radiusx=30, radiusy=40, "
                "rotation=0.000, startangle=0.000, endangle=6.283, anticlockwise=False"
            ),
            {
                "x": 10,
                "y": 20,
                "radiusx": 30,
                "radiusy": 40,
                "rotation": 0.0,
                "startangle": 0.0,
                "endangle": pytest.approx(6.283185),
                "anticlockwise": False,
            },
        ),
        # Rotation
        (
            {"x": 10, "y": 20, "radiusx": 30, "radiusy": 40, "rotation": 1.234},

=====================================================================
Found a 17 line (66 tokens) duplication in the following files: 
Starting at line 196 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 265 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 302 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    wrapped = wrapped_handler(obj, handler)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler, and run until it is complete.
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
        "slept": True,
        "done": True,
    }

=====================================================================
Found a 7 line (66 tokens) duplication in the following files: 
Starting at line 126 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 191 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py

        (None, date(1800, 1, 1)),
        (date(2023, 1, 11), date(2023, 1, 11)),
        (datetime(2023, 2, 11, 10, 42, 37), date(2023, 2, 11)),
        ("2023-03-11", date(2023, 3, 11)),
    ],
)
def test_min(widget, value, expected):

=====================================================================
Found a 22 line (65 tokens) duplication in the following files: 
Starting at line 341 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 704 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.row_count == 0


async def test_row_changes(widget, probe):
    """Rows can be added and removed"""
    # Header is visible
    assert probe.header_visible
    await _row_change_test(widget, probe)


async def test_headerless_row_changes(headerless_widget, headerless_probe):
    """Rows can be added and removed to a headerless table"""
    # Header doesn't exist
    assert not headerless_probe.header_visible
    await _row_change_test(headerless_widget, headerless_probe)


async def _column_change_test(widget, probe):
    """Meta test for adding and removing columns"""
    # Initially 3 columns; Cell 0,2 contains C1
    assert probe.column_count == 3
    probe.assert_cell_content(0, 2, "C0")

=====================================================================
Found a 10 line (65 tokens) duplication in the following files: 
Starting at line 31 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 75 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    app.commands.clear()

    # Put some commands into the app
    cmd_a = toga.Command(None, text="App command a")
    cmd_b = toga.Command(None, text="App command b", order=10)
    app.commands.add(cmd_a, cmd_b)
    assert list(app.commands) == [cmd_a, cmd_b]

    # Create a standalone command set and add some commands
    cs = CommandSet(on_change=change_handler)

=====================================================================
Found a 12 line (65 tokens) duplication in the following files: 
Starting at line 74 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 114 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py

    if change_handler:
        statusiconset.commands.on_change = change_handler

    status_1 = SimpleStatusIcon(id="s1")
    status_2 = SimpleStatusIcon(id="s2")
    status_3 = SimpleStatusIcon(id="s3")
    statusiconset.add(status_1, status_2, status_3)

    assert len(statusiconset) == 3
    assert list(statusiconset) == [status_1, status_2, status_3]

    assert statusiconset["s1"] == status_1

=====================================================================
Found a 11 line (65 tokens) duplication in the following files: 
Starting at line 488 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 561 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert len(context) == 4
    assert len(fill) == 1

    # Draw instructions no longer have the second
    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        # Begin fill
        ("push context", {}),

=====================================================================
Found a 15 line (65 tokens) duplication in the following files: 
Starting at line 61 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 120 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py

@pytest.mark.parametrize(
    "value, expected",
    [
        # float
        (1.23, Decimal("1.23")),
        (1.23e4, Decimal("12300")),
        # Integer
        (123, Decimal("123")),
        # Float and integer specified as string
        ("1.23", Decimal("1.23")),
        ("123", Decimal("123")),
        ("1.23e+4", Decimal("1.23e+4")),
        # Excessive precision is rounded to same number of decimal places as step
        # (see QUANTIZE_PARAMS for related tests).
        ("1.23456", Decimal("1.23")),

=====================================================================
Found a 22 line (65 tokens) duplication in the following files: 
Starting at line 774 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 823 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

            Path("/path/to/initial_file.txt"),
            on_result=on_result_handler,
        )

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is saved_file

    assert_action_performed_with(
        dialog.dialog,
        "create SaveFileDialog",
        title="Title",
        filename="initial_file.txt",
        initial_directory=Path("/path/to"),

=====================================================================
Found a 12 line (64 tokens) duplication in the following files: 
Starting at line 40 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 131 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    assert probe.height == pytest.approx(0, abs=2)
    assert not probe.preserve_aspect_ratio

    # Restore the image; Make the parent a flex row
    # Image will become as wide as the container.
    widget.image = "resources/sample.png"
    widget.style.flex = 1
    widget.parent.style.direction = ROW

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(container_probe.width, abs=2)
    assert probe.height == pytest.approx(container_probe.height, abs=2)

=====================================================================
Found a 10 line (64 tokens) duplication in the following files: 
Starting at line 336 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 346 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Root Node 1 has been collapsed")
    assert probe.is_expanded(source[0])
    assert probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    # State of source[1][2] is ambiguous
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse the same single root node again
    widget.collapse(source[1])

=====================================================================
Found a 8 line (64 tokens) duplication in the following files: 
Starting at line 378 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 398 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])  # Restores previous expansion state
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Expand a single root node again
    widget.expand(source[1])

=====================================================================
Found a 14 line (64 tokens) duplication in the following files: 
Starting at line 220 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_scrollcontainer.py
Starting at line 247 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_scrollcontainer.py

@pytest.mark.parametrize(
    "value, expected",
    [
        (True, True),
        (False, False),
        (42, True),
        (0, False),
        ("True", True),
        ("False", True),  # non-empty string is truthy
        ("", False),
        (object(), True),
    ],
)
def test_horizontal(scroll_container, on_scroll_handler, content, value, expected):

=====================================================================
Found a 9 line (63 tokens) duplication in the following files: 
Starting at line 348 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 358 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    # State of source[1][2] is ambiguous
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse a single child node
    widget.collapse(source[0][2])
    await probe.redraw("Child Node 0:2 has been collapsed")

=====================================================================
Found a 13 line (63 tokens) duplication in the following files: 
Starting at line 382 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 463 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 545 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

    root = ExampleNode(
        "app",
        style=Pack(direction=COLUMN),
        children=[
            ExampleNode(
                "first",
                style=Pack(flex=1),
                size=(100, 100),
            ),
            ExampleNode(
                "second",
                style=Pack(direction=COLUMN, flex=1),
                size=(100, 200),

=====================================================================
Found a 9 line (63 tokens) duplication in the following files: 
Starting at line 447 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 562 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert len(fill) == 1

    # Initial draw instructions are as expected
    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        ("line to", {"x": 20, "y": 30}),

=====================================================================
Found a 14 line (63 tokens) duplication in the following files: 
Starting at line 117 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_button.py
Starting at line 163 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_button.py

    button.icon = icon
    assert isinstance(button.icon, toga.Icon)
    assert button.icon.path == Path("path/to/icon")

    # test backend has the right values
    assert attribute_value(button, "text") == ""
    assert attribute_value(button, "icon").path == Path("path/to/icon")

    # A refresh was performed
    assert_action_performed(button, "refresh")
    EventLog.reset()

    # Change back to text
    button.text = "New value"

=====================================================================
Found a 10 line (62 tokens) duplication in the following files: 
Starting at line 35 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 109 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 162 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py

    document_path = Path(__file__).parent / "docs/example.testbed"
    app.documents.open(document_path)

    await app_probe.redraw("Document has been opened", delay=0.1)

    assert len(app.documents) == 1
    assert len(app.windows) == 2

    # Document has been read.
    app.documents[0]._content.read.assert_called_with(document_path)

=====================================================================
Found a 12 line (62 tokens) duplication in the following files: 
Starting at line 39 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 88 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    assert probe.width == pytest.approx(0, abs=2)
    assert probe.height == pytest.approx(0, abs=2)
    assert not probe.preserve_aspect_ratio

    # Restore the image; Make the parent a flex row
    # Image will become as wide as the container.
    widget.image = "resources/sample.png"
    widget.style.flex = 1
    widget.parent.style.direction = ROW

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(container_probe.width, abs=2)

=====================================================================
Found a 11 line (62 tokens) duplication in the following files: 
Starting at line 89 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 175 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    assert probe.height == pytest.approx(0, abs=2)
    assert not probe.preserve_aspect_ratio

    # Restore the image; Make the parent a flex row
    widget.image = "resources/sample.png"
    widget.style.flex = 1
    widget.parent.style.direction = ROW

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(200, abs=2)
    assert probe.height == pytest.approx(container_probe.height, abs=2)

=====================================================================
Found a 8 line (62 tokens) duplication in the following files: 
Starting at line 318 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 378 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 388 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Fully expand when already fully expanded
    widget.expand()

=====================================================================
Found a 14 line (62 tokens) duplication in the following files: 
Starting at line 854 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 970 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    current_window = doc_app.current_window
    first_doc = current_window.doc
    assert first_doc.path == example_file

    # Open a second new document, set to be current
    second_doc = doc_app.documents.new(ExampleDocument)
    doc_app.current_window = second_doc.main_window

    # Prime the save dialog on the second window
    path = tmp_path / "path/to/filename2.foobar"
    second_doc.main_window._impl.dialog_responses["SaveFileDialog"] = [path]

    # Activate the save menu
    future = doc_app.commands[toga.Command.SAVE].action()

=====================================================================
Found a 16 line (62 tokens) duplication in the following files: 
Starting at line 178 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 41 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py

                style=Pack(direction=COLUMN, padding_left=110, padding_right=120),
                children=[
                    ExampleNode(
                        "widget_a",
                        style=Pack(
                            width=100, height=30, padding_top=32, padding_bottom=34
                        ),
                    ),
                    ExampleNode(
                        "widget_b",
                        style=Pack(
                            width=100, height=36, padding_top=38, padding_bottom=40
                        ),
                    ),
                ],
            ),

=====================================================================
Found a 16 line (62 tokens) duplication in the following files: 
Starting at line 178 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py

                style=Pack(direction=ROW, padding_top=110, padding_bottom=120),
                children=[
                    ExampleNode(
                        "widget_a",
                        style=Pack(
                            width=30, height=100, padding_left=32, padding_right=34
                        ),
                    ),
                    ExampleNode(
                        "widget_b",
                        style=Pack(
                            width=36, height=100, padding_left=38, padding_right=40
                        ),
                    ),
                ],
            ),

=====================================================================
Found a 16 line (62 tokens) duplication in the following files: 
Starting at line 342 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 408 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 442 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    wrapped = wrapped_handler(obj, handler)

    # Raw handler is the original coroutine
    assert wrapped._raw == handler

    # Invoke the handler
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
        "done": True,
    }

=====================================================================
Found a 19 line (62 tokens) duplication in the following files: 
Starting at line 270 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_detailedlist.py
Starting at line 272 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

    assert_action_performed_with(detailedlist, "scroll to row", row=0)


@pytest.mark.parametrize(
    "row, effective",
    [
        # Positive index
        (0, 0),
        (2, 2),
        # Greater index than available rows
        (10, 3),
        # Negative index
        (-1, 2),
        (-3, 0),
        # Greater negative index than available rows
        (-10, 0),
    ],
)
def test_scroll_to_row(detailedlist, row, effective):

=====================================================================
Found a 4 line (61 tokens) duplication in the following files: 
Starting at line 122 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 129 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py

    await probe.redraw("Child should be added to layout")
    probe.assert_layout(position=(0, 0), size=(100, 200))
    other_probe.assert_layout(position=(100, 0), size=(100, 200))
    child_probe.assert_layout(position=(0, 0), size=(50, 75))

=====================================================================
Found a 10 line (61 tokens) duplication in the following files: 
Starting at line 356 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 366 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Child Node 0:2 has been collapsed")
    assert probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    # State of source[1][2] is ambiguous
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse the same child node
    widget.collapse(source[0][2])

=====================================================================
Found a 9 line (61 tokens) duplication in the following files: 
Starting at line 591 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 625 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1
    example_doc = doc_app.documents[0]
    assert example_doc.path == example_file
    orig_position = doc_app.documents[0].main_window.position

    # Mark document 1 as modified; approve the save, and open other_file
    example_doc.touch()
    example_doc.main_window._impl.dialog_responses["QuestionDialog"] = [True]

=====================================================================
Found a 13 line (61 tokens) duplication in the following files: 
Starting at line 43 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 103 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 190 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 255 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

        (200, 100),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),
                },
                {
                    "origin": (100, 0),
                    "content": (100, 100),

=====================================================================
Found a 13 line (61 tokens) duplication in the following files: 
Starting at line 60 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 140 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 221 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

    root = ExampleNode(
        "app",
        style=Pack(direction=ROW),
        children=[
            ExampleNode(
                "first",
                style=Pack(flex=1),
                size=(100, 100),
            ),
            ExampleNode(
                "second",
                style=Pack(direction=ROW, flex=1),
                size=(200, 100),

=====================================================================
Found a 13 line (61 tokens) duplication in the following files: 
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 513 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

        (100, 300),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),
                },
                {
                    "origin": (0, 100),
                    "content": (100, 200),

=====================================================================
Found a 8 line (60 tokens) duplication in the following files: 
Starting at line 328 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 378 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 388 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 408 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 418 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 428 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse a single root node
    widget.collapse(source[1])

=====================================================================
Found a 11 line (60 tokens) duplication in the following files: 
Starting at line 565 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 694 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert doc_app.documents[0].path == example_file
    orig_position = doc_app.documents[0].main_window.position

    # Select the other file as the new document
    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1

=====================================================================
Found a 14 line (60 tokens) duplication in the following files: 
Starting at line 25 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 117 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 150 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py

            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (540, 300),
        (640, 300),
        {
            "origin": (0, 0),
            "content": (640, 300),
            "children": [
                {"origin": (0, 0), "content": (540, 100)},

=====================================================================
Found a 12 line (59 tokens) duplication in the following files: 
Starting at line 192 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py
Starting at line 254 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py

        on_select_handler.assert_called_once_with(widget)
        on_select_handler.reset_mock()

        # Select the last tab programmatically while already on a "more" option
        widget.current_tab = "Tab 8"
        await probe.wait_for_tab("Tab 8 should be selected")

        assert widget.current_tab.index == 7
        assert extra_probes[4].width > probe.width * 0.8
        assert extra_probes[4].height > probe.height * 0.8
        # on_select has been invoked
        on_select_handler.assert_called_once_with(widget)

=====================================================================
Found a 13 line (59 tokens) duplication in the following files: 
Starting at line 222 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 513 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

        (100, 150),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),
                },
                {
                    "origin": (0, 100),
                    "content": (640, 50),

=====================================================================
Found a 17 line (59 tokens) duplication in the following files: 
Starting at line 252 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 489 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    assert widget.children == [child1, child2, child3]
    assert child1.parent == widget
    assert child2.parent == widget
    assert child3.parent == widget

    # Children has inherited parent's app/window details
    assert child1.app == app
    assert child1.window == window

    assert child2.app == app
    assert child2.window == window

    assert child3.app == app
    assert child3.window == window

    # The impl's add_child has been invoked 3 time
    assert_action_performed_with(widget, "add child", child=child1._impl)

=====================================================================
Found a 3 line (59 tokens) duplication in the following files: 
Starting at line 60 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 127 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 192 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py

        (date(2023, 1, 11), date(2023, 1, 11)),
        (datetime(2023, 2, 11, 10, 42, 37), date(2023, 2, 11)),
        ("2023-03-11", date(2023, 3, 11)),

=====================================================================
Found a 7 line (59 tokens) duplication in the following files: 
Starting at line 441 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py
Starting at line 496 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py

    impl.set_min(-0.4)
    assert impl.get_min() == pytest.approx(-0.4)
    impl.set_max(0.6)
    assert impl.get_max() == pytest.approx(0.6)
    impl.set_value(0.5)
    assert impl.get_value() == 0.5
    assert impl.int_value == 9000

=====================================================================
Found a 12 line (59 tokens) duplication in the following files: 
Starting at line 82 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 48 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py

        id="my-window",
        title="My Window",
        position=toga.Position(10, 20),
        size=toga.Position(200, 300),
        resizable=False,
        minimizable=False,
        content=window_content,
        on_close=on_close_handler,
    )

    assert window.app == app
    assert window.content == window_content

=====================================================================
Found a 19 line (58 tokens) duplication in the following files: 
Starting at line 76 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py
Starting at line 49 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/conftest.py

async def widget(
    on_resize_handler,
    on_press_handler,
    on_activate_handler,
    on_release_handler,
    on_drag_handler,
    on_alt_press_handler,
    on_alt_release_handler,
    on_alt_drag_handler,
):
    return toga.Canvas(
        on_resize=on_resize_handler,
        on_press=on_press_handler,
        on_activate=on_activate_handler,
        on_release=on_release_handler,
        on_drag=on_drag_handler,
        on_alt_press=on_alt_press_handler,
        on_alt_release=on_alt_release_handler,
        on_alt_drag=on_alt_drag_handler,

=====================================================================
Found a 11 line (58 tokens) duplication in the following files: 
Starting at line 263 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 309 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    cs = CommandSet(on_change=change_handler)

    # Define some commands
    cmd_a = toga.Command(None, text="App command a", id="custom-command-a")
    cmd_b = toga.Command(None, text="App command b", id="custom-command-b")
    cs.add(cmd_a, cmd_b)
    if change_handler:
        change_handler.reset_mock()

    # discard one of the commands
    cs.discard(cmd_a)

=====================================================================
Found a 11 line (58 tokens) duplication in the following files: 
Starting at line 329 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 348 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

    assert len(source) == 2
    assert source[0].val1 == "first"
    assert source[0].val2 == 111

    assert source[1].val1 == "third"
    assert source[1].val2 == 333

    listener.remove.assert_called_once_with(item=row, index=1)


def test_remove(source):

=====================================================================
Found a 15 line (58 tokens) duplication in the following files: 
Starting at line 142 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_fonts.py
Starting at line 171 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_fonts.py

    )


@pytest.mark.parametrize(
    "path, registered",
    [
        # Absolute path
        (Path("/path/to/custom/font.otf"), Path("/path/to/custom/font.otf")),
        (str(Path("/path/to/custom/font.otf")), Path("/path/to/custom/font.otf")),
        # Relative path
        (
            Path("path/to/custom/font.otf"),
            Path(toga.__file__).parent / "path/to/custom/font.otf",
        ),
        (

=====================================================================
Found a 9 line (58 tokens) duplication in the following files: 
Starting at line 447 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 489 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert len(fill) == 1

    # Initial draw instructions are as expected
    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        ("line to", {"x": 20, "y": 30}),

=====================================================================
Found a 10 line (58 tokens) duplication in the following files: 
Starting at line 525 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 562 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert len(fill) == 1

    # Draw instructions show the new position
    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        # Begin fill
        ("push context", {}),

=====================================================================
Found a 14 line (57 tokens) duplication in the following files: 
Starting at line 196 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 408 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 442 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    wrapped = wrapped_handler(obj, handler)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler, and run until it is complete.
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},

=====================================================================
Found a 14 line (57 tokens) duplication in the following files: 
Starting at line 265 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 302 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 342 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    wrapped = wrapped_handler(obj, handler, cleanup=cleanup)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42
    )

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},

=====================================================================
Found a 12 line (56 tokens) duplication in the following files: 
Starting at line 27 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_divider.py
Starting at line 63 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_divider.py

    assert widget.direction == Direction.HORIZONTAL
    assert probe.height < 10
    assert probe.width < 10

    # Make the container a column box so the divider will become wide.
    widget.parent.style.direction = COLUMN
    await probe.redraw("Divider should become wide")

    # The divider will now be wide, but short.
    assert widget.direction == Direction.HORIZONTAL
    assert probe.height < 10
    assert probe.width > 100

=====================================================================
Found a 8 line (56 tokens) duplication in the following files: 
Starting at line 216 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 239 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 263 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 286 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 309 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 332 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    cs = CommandSet(on_change=change_handler)

    # Define some commands
    cmd_a = toga.Command(None, text="App command a", id="custom-command-a")
    cmd_b = toga.Command(None, text="App command b", id="custom-command-b")
    cs.add(cmd_a, cmd_b)
    if change_handler:
        change_handler.reset_mock()

=====================================================================
Found a 6 line (56 tokens) duplication in the following files: 
Starting at line 450 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 581 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        ("line to", {"x": 20, "y": 30}),

=====================================================================
Found a 16 line (56 tokens) duplication in the following files: 
Starting at line 559 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 682 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        dialog = window.info_dialog("Title", "Body", on_result=on_result_handler)

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is None

    assert_action_performed_with(
        dialog.dialog,

=====================================================================
Found a 15 line (56 tokens) duplication in the following files: 
Starting at line 759 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 807 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

    on_result_handler = Mock()

    # Prime the user's response
    saved_file = Path("/saved/path/filename.txt")
    window._impl.dialog_responses["SaveFileDialog"] = [saved_file]

    with pytest.warns(
        DeprecationWarning,
        match=r"Synchronous `on_result` handlers have been deprecated;",
    ), pytest.warns(
        DeprecationWarning,
        match=r"save_file_dialog\(...\) has been deprecated; use dialog\(toga.SaveFileDialog\(...\)\)",
    ):
        dialog = window.save_file_dialog(
            "Title",

=====================================================================
Found a 11 line (55 tokens) duplication in the following files: 
Starting at line 138 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_dateinput.py
Starting at line 117 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_timeinput.py

        expected = date(2023, 5, 20 + i)
        assert widget.value == expected
        assert probe.value == expected
        assert on_change.mock_calls == [call(widget)] * i

    # Can't go past the maximum
    assert widget.value == widget.max
    await probe.change(1)
    assert widget.value == widget.max

    widget.value = date(2023, 5, 20)

=====================================================================
Found a 11 line (55 tokens) duplication in the following files: 
Starting at line 37 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_detailedlist.py
Starting at line 27 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

        accessors=["key", "value", "icon"],
        data=[
            {"key": "first", "value": 111, "other": "aaa"},
            {"key": "second", "value": 222, "other": "bbb"},
            {"key": "third", "value": 333, "other": "ccc"},
        ],
    )


@pytest.fixture
def detailedlist(

=====================================================================
Found a 18 line (55 tokens) duplication in the following files: 
Starting at line 62 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 218 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py

        content=[content1._impl, content2._impl],
        flex=[1, 1],
    )

    # The split container has been refreshed
    assert_action_performed(splitcontainer, "refresh")


@pytest.mark.parametrize(
    "include_left, include_right",
    [
        (False, False),
        (False, True),
        (True, False),
        (True, True),
    ],
)
def test_assign_to_app(app, content1, content2, include_left, include_right):

=====================================================================
Found a 4 line (54 tokens) duplication in the following files: 
Starting at line 128 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 241 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 276 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 302 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 331 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert len(app.windows) == 1
    assert list(app.windows)[0] == app.documents[0].main_window
    assert_action_performed(app.documents[0].main_window, "create MainWindow")
    assert_action_performed(app.documents[0].main_window, "show")

=====================================================================
Found a 8 line (54 tokens) duplication in the following files: 
Starting at line 569 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 600 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 634 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 772 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

=====================================================================
Found a 13 line (54 tokens) duplication in the following files: 
Starting at line 184 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 253 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        yield 0.01  # A short sleep
        handler_call["slept"] = True
        yield  # A yield without a sleep
        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler)

=====================================================================
Found a 9 line (54 tokens) duplication in the following files: 
Starting at line 140 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py
Starting at line 168 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py
Starting at line 202 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py

        -1 * pi,
        [
            (1.0, 0.0),
            (1.0, -0.5522847),
            (0.5522847, -1.0),
            (0.0, -1.0),
            (-0.5522847, -1.0),
            (-1.0, -0.5522847),
            (-1.0, 0.0),

=====================================================================
Found a 16 line (54 tokens) duplication in the following files: 
Starting at line 600 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 641 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        dialog = window.question_dialog("Title", "Body", on_result=on_result_handler)

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog)

    assert_action_performed_with(
        dialog.dialog,

=====================================================================
Found a 26 line (53 tokens) duplication in the following files: 
Starting at line 414 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 485 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

        await app_probe.redraw("App converted to session-based app")

        # Try to close the main window. This is monkeypatched, so it
        # will record whether a close was allowed, but won't actually
        # close or remove the window, so the window will still exist.
        main_window.close()
        await app_probe.redraw("Simulate close of main window; app should not exit")

        # The main window will be closed
        mock_main_window_close.assert_called_once()
        mock_main_window_close.reset_mock()

        # The app will *not* have been prompted to exit, because there
        # is still an open window, and this is a session-based app.
        on_exit_handler.assert_not_called()
        on_exit_handler.reset_mock()

        # Close the secondary window.
        secondary_window.close()
        secondary_window = None
        await app_probe.redraw("Secondary window has been closed")

        # Try to close the main window again. This time, the main
        # window is the last open window; the backend's session behavior
        # defines whether the app exits.
        main_window.close()

=====================================================================
Found a 8 line (53 tokens) duplication in the following files: 
Starting at line 698 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 799 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There are now 2 documents, and 2 windows
    assert len(doc_app.documents) == 2
    assert len(doc_app.windows) == 2

=====================================================================
Found a 7 line (53 tokens) duplication in the following files: 
Starting at line 13 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_widget_registry.py
Starting at line 7 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

class ExampleWidget(toga.Widget):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._impl = self.factory.Widget(self)

    def __repr__(self):
        return f"Widget(id={self.id!r})"

=====================================================================
Found a 11 line (53 tokens) duplication in the following files: 
Starting at line 332 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 398 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    async def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        await asyncio.sleep(0.01)  # A short sleep
        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler)

=====================================================================
Found a 9 line (52 tokens) duplication in the following files: 
Starting at line 153 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_dateinput.py
Starting at line 132 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_timeinput.py

        expected = date(2023, 5, 20 - i)
        assert widget.value == expected
        assert probe.value == expected
        assert on_change.mock_calls == [call(widget)] * i

    # Can't go past the minimum
    assert widget.value == widget.min
    await probe.change(-1)
    assert widget.value == widget.min

=====================================================================
Found a 12 line (52 tokens) duplication in the following files: 
Starting at line 201 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py
Starting at line 243 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py

        assert extra_probes[4].height > probe.height * 0.8
        # on_select has been invoked
        on_select_handler.assert_called_once_with(widget)
        on_select_handler.reset_mock()

        # Select the first tab in the GUI
        probe.select_tab(0)
        await probe.wait_for_tab("Tab 0 should be selected")
        assert widget.current_tab.index == 0
        # on_select has been invoked
        on_select_handler.assert_called_once_with(widget)
        on_select_handler.reset_mock()

=====================================================================
Found a 8 line (52 tokens) duplication in the following files: 
Starting at line 338 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 358 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    # State of source[1][2] is ambiguous
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse the same single root node again
    widget.collapse(source[1])

=====================================================================
Found a 14 line (52 tokens) duplication in the following files: 
Starting at line 264 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 313 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py

            {"x": 10, "y": 20, "radius": 30},
            "x=10, y=20, radius=30, startangle=0.000, endangle=6.283, anticlockwise=False",
            {
                "x": 10,
                "y": 20,
                "radius": 30,
                "startangle": 0.0,
                "endangle": pytest.approx(6.283185),
                "anticlockwise": False,
            },
        ),
        # Start angle
        (
            {"x": 10, "y": 20, "radius": 30, "startangle": 1.234},

=====================================================================
Found a 9 line (52 tokens) duplication in the following files: 
Starting at line 55 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py
Starting at line 63 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

    assert sorted(app.widgets.values()) == [
        win_1.content,
        win_1.content.children[0],
        win_1.content.children[1],
        win_2.content,
        win_2.content.children[0],
        win_2.content.children[1],
    ]
    assert sorted(iter(app.widgets)) == [

=====================================================================
Found a 3 line (51 tokens) duplication in the following files: 
Starting at line 132 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_mapview.py
Starting at line 165 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_mapview.py

    fremantle = toga.MapPin((-32.05423, 115.74763), title="Fremantle")
    lesmurdie = toga.MapPin((-31.994, 116.05), title="lesmurdie")
    joondalup = toga.MapPin((-31.745, 115.766), title="Joondalup")

=====================================================================
Found a 8 line (51 tokens) duplication in the following files: 
Starting at line 229 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 240 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expanding/collapsing nodes when tree is not expanded
    # Expand a single root node
    widget.expand(source[1])
    await probe.redraw("Root Node 1 has been expanded")

=====================================================================
Found a 13 line (51 tokens) duplication in the following files: 
Starting at line 903 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 1018 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    current_window = doc_app.current_window
    first_doc = current_window.doc
    assert first_doc.path == example_file

    # Open a second new document
    second_doc = doc_app.documents.new(ExampleDocument)

    # Open a non-document window, and make it current
    third_window = toga.Window(title="Not a document")
    doc_app.current_window = third_window

    # Activate the save menu
    future = doc_app.commands[toga.Command.SAVE].action()

=====================================================================
Found a 12 line (51 tokens) duplication in the following files: 
Starting at line 43 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 103 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 222 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 190 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 255 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 513 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

        (200, 100),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),
                },
                {
                    "origin": (100, 0),

=====================================================================
Found a 13 line (51 tokens) duplication in the following files: 
Starting at line 73 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 129 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 158 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    wrapped = wrapped_handler(obj, handler)

    # Raw handler is the original function
    assert wrapped._raw == handler

    # Invoke wrapper; handler return value is preserved
    assert wrapped("arg1", "arg2", kwarg1=3, kwarg2=4) == 42

    # Handler arguments are as expected.
    assert handler_call == {
        "args": (obj, "arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
    }

=====================================================================
Found a 13 line (51 tokens) duplication in the following files: 
Starting at line 184 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 290 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        yield 0.01  # A short sleep
        handler_call["slept"] = True
        yield  # A yield without a sleep
        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler)

=====================================================================
Found a 7 line (51 tokens) duplication in the following files: 
Starting at line 492 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 528 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 581 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),
        # Begin fill
        ("push context", {}),

=====================================================================
Found a 15 line (51 tokens) duplication in the following files: 
Starting at line 75 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py
Starting at line 256 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py

    handler.assert_called_once_with(widget)


@pytest.mark.parametrize(
    "value, expected",
    [
        (None, False),
        ("", False),
        ("true", True),
        ("false", True),  # Evaluated as a string, this value is true.
        (0, False),
        (1234, True),
    ],
)
def test_readonly(widget, value, expected):

=====================================================================
Found a 15 line (51 tokens) duplication in the following files: 
Starting at line 315 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py
Starting at line 338 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

    table.insert_column("value", "New Column", accessor="extra")

    # The column was added
    assert_action_performed_with(
        table,
        "insert column",
        index=1,
        heading="New Column",
        accessor="extra",
    )
    assert table.headings == ["Title", "New Column", "Value"]
    assert table.accessors == ["key", "extra", "value"]


def test_insert_column_unknown_accessor(table):

=====================================================================
Found a 15 line (51 tokens) duplication in the following files: 
Starting at line 372 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py
Starting at line 390 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

    table.insert_column(-2, "New Column", accessor="extra")

    # The column was added
    assert_action_performed_with(
        table,
        "insert column",
        index=0,
        heading="New Column",
        accessor="extra",
    )
    assert table.headings == ["New Column", "Title", "Value"]
    assert table.accessors == ["extra", "key", "value"]


def test_insert_column_big_negative_index(table):

=====================================================================
Found a 15 line (51 tokens) duplication in the following files: 
Starting at line 345 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py
Starting at line 368 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py

    tree.insert_column("value", "New Column", accessor="extra")

    # The column was added
    assert_action_performed_with(
        tree,
        "insert column",
        index=1,
        heading="New Column",
        accessor="extra",
    )
    assert tree.headings == ["Title", "New Column", "Value"]
    assert tree.accessors == ["key", "extra", "value"]


def test_insert_column_unknown_accessor(tree):

=====================================================================
Found a 15 line (51 tokens) duplication in the following files: 
Starting at line 402 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py
Starting at line 420 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py

    tree.insert_column(-2, "New Column", accessor="extra")

    # The column was added
    assert_action_performed_with(
        tree,
        "insert column",
        index=0,
        heading="New Column",
        accessor="extra",
    )
    assert tree.headings == ["New Column", "Title", "Value"]
    assert tree.accessors == ["extra", "key", "value"]


def test_insert_column_big_negative_index(tree):

=====================================================================
Found a 12 line (50 tokens) duplication in the following files: 
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 139 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 163 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py

    app.documents.open(document_path)

    await app_probe.redraw("Document has been opened", delay=0.1)

    assert len(app.documents) == 1
    assert len(app.windows) == 2

    # Document has been read.
    app.documents[0]._content.read.assert_called_with(document_path)

    # Save the document
    await app.documents.save()

=====================================================================
Found a 16 line (50 tokens) duplication in the following files: 
Starting at line 161 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 219 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    monkeypatch.setattr(DummyApp, "HANDLES_COMMAND_LINE", True)

    app = ExampleDocumentApp(
        "Test App",
        "org.beeware.document-app",
        document_types=[ExampleDocument],
    )

    assert app._impl.interface == app
    assert_action_performed(app, "create App")

    assert app.documents.types == [ExampleDocument]

    # A default document has been created
    assert len(app.documents) == 1
    assert len(app.windows) == 1

=====================================================================
Found a 11 line (50 tokens) duplication in the following files: 
Starting at line 332 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    async def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        await asyncio.sleep(0.01)  # A short sleep
        handler_call["done"] = True
        return 42

    wrapped = wrapped_handler(obj, handler)

=====================================================================
Found a 9 line (50 tokens) duplication in the following files: 
Starting at line 471 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 549 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 40, "y": 50}),
        ("pop context", {}),
        ("line to", {"x": 99, "y": 99}),
        ("pop context", {}),
    ]

    # Remove the second draw instruction
    context.remove(second)

=====================================================================
Found a 9 line (50 tokens) duplication in the following files: 
Starting at line 512 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 571 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 40, "y": 50}),
        ("pop context", {}),
        ("line to", {"x": 99, "y": 99}),
        ("pop context", {}),
    ]

    # Insert the second draw instruction at index 3
    context.insert(3, second)

=====================================================================
Found a 12 line (50 tokens) duplication in the following files: 
Starting at line 1162 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 78 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py
Starting at line 257 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py
Starting at line 146 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

@pytest.mark.parametrize(
    "value, expected",
    [
        (None, False),
        ("", False),
        ("true", True),
        ("false", True),  # Evaluated as a string, this value is true.
        (0, False),
        (1234, True),
    ],
)
def test_enabled(widget, value, expected):

=====================================================================
Found a 17 line (50 tokens) duplication in the following files: 
Starting at line 1 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 1 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_timeinput.py

from datetime import date, datetime, time
from unittest.mock import Mock

import pytest

import toga
from toga_dummy.utils import assert_action_performed


@pytest.fixture
def on_change_handler():
    return Mock()


@pytest.fixture
def widget(on_change_handler):
    return toga.DateInput(on_change=on_change_handler)

=====================================================================
Found a 12 line (50 tokens) duplication in the following files: 
Starting at line 32 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_passwordinput.py
Starting at line 51 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

    widget = toga.PasswordInput(
        value="Some text",
        placeholder="A placeholder",
        readonly=True,
        on_change=on_change,
        on_confirm=on_confirm,
        on_gain_focus=on_gain_focus,
        on_lose_focus=on_lose_focus,
        validators=[validator1, validator2],
    )
    assert widget._impl.interface == widget
    assert_action_performed(widget, "create PasswordInput")

=====================================================================
Found a 15 line (50 tokens) duplication in the following files: 
Starting at line 355 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py
Starting at line 452 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

    table.insert_column(100, "New Column", accessor="extra")

    # The column was added
    assert_action_performed_with(
        table,
        "insert column",
        index=2,
        heading="New Column",
        accessor="extra",
    )
    assert table.headings == ["Title", "Value", "New Column"]
    assert table.accessors == ["key", "value", "extra"]


def test_insert_column_negative_index(table):

=====================================================================
Found a 15 line (50 tokens) duplication in the following files: 
Starting at line 385 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py
Starting at line 482 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py

    tree.insert_column(100, "New Column", accessor="extra")

    # The column was added
    assert_action_performed_with(
        tree,
        "insert column",
        index=2,
        heading="New Column",
        accessor="extra",
    )
    assert tree.headings == ["Title", "Value", "New Column"]
    assert tree.accessors == ["key", "value", "extra"]


def test_insert_column_negative_index(tree):

=====================================================================
Found a 14 line (50 tokens) duplication in the following files: 
Starting at line 52 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py
Starting at line 48 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        resizable=False,
        minimizable=False,
        content=window_content,
        on_close=on_close_handler,
    )

    assert window.app == app
    assert window.content == window_content

    window_content.window == window
    window_content.app == app

    assert window._impl.interface == window
    assert_action_performed(window, "create MainWindow")

=====================================================================
Found a 16 line (50 tokens) duplication in the following files: 
Starting at line 922 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 1020 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

            file_types=[".txt", ".pdf"],
            multiple_select=True,
            on_result=on_result_handler,
        )

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is opened_files

=====================================================================
Found a 6 line (49 tokens) duplication in the following files: 
Starting at line 36 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 47 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 59 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py

    assert not grandchild_probe.is_hidden
    probe.assert_layout(position=(0, 0), size=(100, 200))
    other_probe.assert_layout(position=(100, 0), size=(100, 200))

    # Hide the widget
    widget.style.visibility = HIDDEN

=====================================================================
Found a 7 line (49 tokens) duplication in the following files: 
Starting at line 192 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_detailedlist.py
Starting at line 215 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_detailedlist.py

    await probe.redraw("Empty row has been inserted")

    assert probe.row_count == 7
    # Missing value has been populated
    probe.assert_cell_content(2, "MISSING!", "MISSING!", icon=None)
    probe.assert_cell_content(5, "<data 4>", "4", icon=None)
    probe.assert_cell_content(6, "AX", "BX", icon=green)

=====================================================================
Found a 7 line (49 tokens) duplication in the following files: 
Starting at line 52 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 144 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py

def test_center():
    root = ExampleNode(
        "root",
        style=Pack(direction=COLUMN, alignment=CENTER, height=300),
        children=[
            ExampleNode("space_filler", style=Pack(width=540, height=100)),
            ExampleNode(

=====================================================================
Found a 7 line (49 tokens) duplication in the following files: 
Starting at line 52 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 144 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py

def test_center():
    root = ExampleNode(
        "root",
        style=Pack(direction=ROW, alignment=CENTER, width=300),
        children=[
            ExampleNode("space_filler", style=Pack(width=100, height=540)),
            ExampleNode(

=====================================================================
Found a 10 line (49 tokens) duplication in the following files: 
Starting at line 134 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_documents.py
Starting at line 157 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_documents.py

    path.write_text("sample file")

    # Read the file
    doc.open(converter(path))

    # Calling absolute() ensures the expected value is correct on Windows
    assert doc.path == path.absolute()
    assert doc.content == "file content"
    assert doc._mock_content.read(path.absolute())
    assert not doc.modified

=====================================================================
Found a 9 line (49 tokens) duplication in the following files: 
Starting at line 128 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py
Starting at line 153 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py
Starting at line 184 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_helpers.py

        1 * pi,
        [
            (1.0, 0.0),
            (1.0, 0.5522847),
            (0.5522847, 1.0),
            (0.0, 1.0),
            (-0.5522847, 1.0),
            (-1.0, 0.5522847),
            (-1.0, 0.0),

=====================================================================
Found a 2 line (48 tokens) duplication in the following files: 
Starting at line 106 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 173 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 365 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

    window1 = toga.Window("Test Window 1", position=(150, 150), size=(200, 200))
    window2 = toga.Window("Test Window 2", position=(400, 150), size=(200, 200))

=====================================================================
Found a 4 line (48 tokens) duplication in the following files: 
Starting at line 122 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 129 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 138 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py

    await probe.redraw("Child should be added to layout")
    probe.assert_layout(position=(0, 0), size=(100, 200))
    other_probe.assert_layout(position=(100, 0), size=(100, 200))
    child_probe.assert_layout(position=(0, 0), size=(50, 75))

=====================================================================
Found a 8 line (48 tokens) duplication in the following files: 
Starting at line 338 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 348 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 368 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    # State of source[1][2] is ambiguous
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse the same single root node again
    widget.collapse(source[1])

=====================================================================
Found a 15 line (48 tokens) duplication in the following files: 
Starting at line 161 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 195 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 219 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    monkeypatch.setattr(DummyApp, "HANDLES_COMMAND_LINE", True)

    app = ExampleDocumentApp(
        "Test App",
        "org.beeware.document-app",
        document_types=[ExampleDocument],
    )

    assert app._impl.interface == app
    assert_action_performed(app, "create App")

    assert app.documents.types == [ExampleDocument]

    # A default document has been created
    assert len(app.documents) == 1

=====================================================================
Found a 11 line (48 tokens) duplication in the following files: 
Starting at line 669 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 721 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 739 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    example_doc.main_window._impl.dialog_responses["SaveFileDialog"] = [None]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

    # The open document is still the example doc
    assert doc_app.documents[-1] == example_doc

=====================================================================
Found a 11 line (48 tokens) duplication in the following files: 
Starting at line 669 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 772 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    example_doc.main_window._impl.dialog_responses["SaveFileDialog"] = [None]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

    # The open document is still the example doc
    assert doc_app.documents[-1] == example_doc

=====================================================================
Found a 10 line (48 tokens) duplication in the following files: 
Starting at line 13 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 134 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py

        style=Pack(direction=ROW),
        children=[
            ExampleNode(
                "first",
                style=Pack(width=100, height=100),
                size=(at_least(0), at_least(0)),
            ),
            ExampleNode(
                "second",
                style=Pack(direction=ROW, width=100, height=100),

=====================================================================
Found a 12 line (48 tokens) duplication in the following files: 
Starting at line 288 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 613 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

                style=Pack(direction=COLUMN, flex=1),
                children=[
                    ExampleNode(
                        "textbox",
                        size=(at_least(100), at_least(100)),
                        style=Pack(flex=1),
                    )
                ],
            ),
            ExampleNode(
                "Button",
                size=(20, at_least(100)),

=====================================================================
Found a 15 line (48 tokens) duplication in the following files: 
Starting at line 123 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_icons.py
Starting at line 152 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_icons.py

    )

    icon = toga.Icon("resources/missing")

    assert icon._impl is not None
    assert icon._impl.interface == toga.Icon.DEFAULT_ICON

    # A warning was printed; allow for windows separators
    assert (
        "WARNING: Can't find icon resources/missing"
        in capsys.readouterr().out.replace("\\", "/")
    )


def test_create_fallback_unloadable(monkeypatch, app, capsys):

=====================================================================
Found a 9 line (48 tokens) duplication in the following files: 
Starting at line 471 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 571 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 601 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 40, "y": 50}),
        ("pop context", {}),
        ("line to", {"x": 99, "y": 99}),
        ("pop context", {}),
    ]

    # Remove the second draw instruction
    context.remove(second)

=====================================================================
Found a 9 line (48 tokens) duplication in the following files: 
Starting at line 512 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 549 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

        ("line to", {"x": 30, "y": 40}),
        ("line to", {"x": 40, "y": 50}),
        ("pop context", {}),
        ("line to", {"x": 99, "y": 99}),
        ("pop context", {}),
    ]

    # Insert the second draw instruction at index 3
    context.insert(3, second)

=====================================================================
Found a 13 line (48 tokens) duplication in the following files: 
Starting at line 685 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 785 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

            "begin path",
            {
                "fill_color": rgb(255, 0, 0),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        (
            "line to",
            {
                "x": 100,

=====================================================================
Found a 13 line (48 tokens) duplication in the following files: 
Starting at line 718 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 751 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

            "begin path",
            {
                "fill_color": rgb(0, 0, 255),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        (
            "line to",
            {
                "x": 200,

=====================================================================
Found a 19 line (48 tokens) duplication in the following files: 
Starting at line 114 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py
Starting at line 181 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

        ("Contains\nnewline", "Contains\nnewline"),
    ],
)
def test_placeholder(widget, value, expected):
    """The value of the placeholder can be set."""
    # Clear the event log
    EventLog.reset()

    widget.placeholder = value
    assert widget.placeholder == expected

    # test backend has the right value
    assert attribute_value(widget, "placeholder") == expected

    # A refresh was performed
    assert_action_performed(widget, "refresh")


def test_scroll(widget):

=====================================================================
Found a 9 line (48 tokens) duplication in the following files: 
Starting at line 413 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py
Starting at line 467 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py

def test_int_impl_continuous():
    impl = DummyIntImpl()
    assert impl.get_value() == 0

    impl.set_min(0)
    assert impl.get_min() == 0
    impl.set_max(1)
    assert impl.get_max() == 1
    impl.set_tick_count(None)

=====================================================================
Found a 19 line (48 tokens) duplication in the following files: 
Starting at line 7 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py
Starting at line 7 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py

from toga_dummy.utils import (
    assert_action_not_performed,
    assert_action_performed,
    assert_action_performed_with,
)


@pytest.fixture
def on_select_handler():
    return Mock()


@pytest.fixture
def on_activate_handler():
    return Mock()


@pytest.fixture
def source():

=====================================================================
Found a 13 line (48 tokens) duplication in the following files: 
Starting at line 559 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 600 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 641 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 682 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        dialog = window.info_dialog("Title", "Body", on_result=on_result_handler)

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is None

=====================================================================
Found a 16 line (48 tokens) duplication in the following files: 
Starting at line 559 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 682 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 728 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        dialog = window.info_dialog("Title", "Body", on_result=on_result_handler)

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is None

    assert_action_performed_with(
        dialog.dialog,

=====================================================================
Found a 11 line (47 tokens) duplication in the following files: 
Starting at line 40 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 175 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    assert probe.height == pytest.approx(0, abs=2)
    assert not probe.preserve_aspect_ratio

    # Restore the image; Make the parent a flex row
    # Image will become as wide as the container.
    widget.image = "resources/sample.png"
    widget.style.flex = 1
    widget.parent.style.direction = ROW

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(container_probe.width, abs=2)

=====================================================================
Found a 10 line (47 tokens) duplication in the following files: 
Starting at line 89 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 131 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    assert probe.height == pytest.approx(0, abs=2)
    assert not probe.preserve_aspect_ratio

    # Restore the image; Make the parent a flex row
    widget.image = "resources/sample.png"
    widget.style.flex = 1
    widget.parent.style.direction = ROW

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(200, abs=2)

=====================================================================
Found a 8 line (47 tokens) duplication in the following files: 
Starting at line 133 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_selection.py
Starting at line 182 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_selection.py

    widget.items = ListSource(
        accessors=["name", "value"],
        data=[
            {"name": "first", "value": 111},
            {"name": "second", "value": 222},
            {"name": "third", "value": 333},
        ],
    )

=====================================================================
Found a 5 line (47 tokens) duplication in the following files: 
Starting at line 237 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 247 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 257 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 267 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 277 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 287 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 377 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 387 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])

=====================================================================
Found a 7 line (47 tokens) duplication in the following files: 
Starting at line 290 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 300 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 440 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Fully collapse the tree
    widget.collapse()
    await probe.redraw("All nodes have been collapsed")

=====================================================================
Found a 8 line (47 tokens) duplication in the following files: 
Starting at line 559 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 645 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    await probe.redraw("Full row has been appended to a non-expanded root")

    assert probe.child_count((0,)) == 6
    probe.assert_cell_content((0, 4), 0, "A4")
    probe.assert_cell_content((0, 5), 0, "AX")

    # Append a child to a non-expanded child
    widget.data[0][5].append({"a": "AXX", "b": "BXX", "c": "CXX"})

=====================================================================
Found a 12 line (47 tokens) duplication in the following files: 
Starting at line 287 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 368 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py

    assert node[1] == new_child

    # A child node was created using the source's factory, and the child data was passed
    # to that call.
    source._create_node.assert_called_with(
        parent=node,
        data={"val1": "new"},
        children=[
            ({"val1": "new child 1"}, None),
            ({"val1": "new child 2"}, None),
        ],
    )

=====================================================================
Found a 20 line (47 tokens) duplication in the following files: 
Starting at line 1 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_detailedlist.py
Starting at line 1 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

from unittest.mock import Mock

import pytest

import toga
from toga.sources import ListSource
from toga_dummy.utils import (
    assert_action_not_performed,
    assert_action_performed,
    assert_action_performed_with,
)


@pytest.fixture
def on_select_handler():
    return Mock()


@pytest.fixture
def on_refresh_handler():

=====================================================================
Found a 20 line (47 tokens) duplication in the following files: 
Starting at line 148 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py
Starting at line 196 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

    assert_action_performed(widget, "scroll to bottom")


def test_on_change(widget):
    """The on_change handler can be invoked."""
    # No handler initially
    assert widget._on_change._raw is None

    # Define and set a new callback
    handler = Mock()

    widget.on_change = handler

    assert widget.on_change._raw == handler

    # Invoke the callback
    widget._impl.simulate_change()

    # Callback was invoked
    handler.assert_called_once_with(widget)

=====================================================================
Found a 17 line (47 tokens) duplication in the following files: 
Starting at line 63 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 219 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 255 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py

        flex=[1, 1],
    )

    # The split container has been refreshed
    assert_action_performed(splitcontainer, "refresh")


@pytest.mark.parametrize(
    "include_left, include_right",
    [
        (False, False),
        (False, True),
        (True, False),
        (True, True),
    ],
)
def test_assign_to_app(app, content1, content2, include_left, include_right):

=====================================================================
Found a 12 line (47 tokens) duplication in the following files: 
Starting at line 370 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 389 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

    window.show()
    assert window.app == app
    assert window in app.windows

    # Close the window
    window._impl.simulate_close()

    # Window has been closed, and is no longer in the app's list of windows.
    assert window.closed
    assert window.app == app
    assert window not in app.windows
    assert_action_performed(window, "close")

=====================================================================
Found a 15 line (47 tokens) duplication in the following files: 
Starting at line 774 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 971 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

            Path("/path/to/initial_file.txt"),
            on_result=on_result_handler,
        )

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is saved_file

=====================================================================
Found a 12 line (46 tokens) duplication in the following files: 
Starting at line 268 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 292 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

        and window1_widget_probe.height == initial_window1_widget_size[1]
    )

    assert not app_probe.is_full_screen(window2)
    assert app_probe.content_size(window2) == initial_content2_size
    assert (
        window2_widget_probe.width == initial_window2_widget_size[0]
        and window2_widget_probe.height == initial_window2_widget_size[1]
    )

    # Go full screen again on window 1
    app.set_full_screen(window1)

=====================================================================
Found a 4 line (46 tokens) duplication in the following files: 
Starting at line 115 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 145 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py

    await probe.redraw("Child should not in layout yet")
    probe.assert_layout(position=(0, 0), size=(100, 200))
    other_probe.assert_layout(position=(100, 0), size=(100, 200))
    child_probe.assert_not_contained()

=====================================================================
Found a 9 line (46 tokens) duplication in the following files: 
Starting at line 163 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 183 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    await probe.redraw("Image has explicit sizing")
    assert probe.width == pytest.approx(200, abs=2)
    assert probe.height == pytest.approx(300, abs=2)
    assert not probe.preserve_aspect_ratio
    # Image is the size specified.
    probe.assert_image_size(200, 300)

    # Clear the image; it's now an explicit sized empty image.
    widget.image = None

=====================================================================
Found a 9 line (46 tokens) duplication in the following files: 
Starting at line 50 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_command.py
Starting at line 107 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_command.py

    cmd = toga.Command(None, "Test command")

    assert cmd.text == "Test command"
    assert cmd.shortcut is None
    assert cmd.tooltip is None
    assert cmd.group == toga.Group.COMMANDS
    assert cmd.section == 0
    assert cmd.order == 0
    assert cmd.action._raw is None

=====================================================================
Found a 8 line (46 tokens) duplication in the following files: 
Starting at line 10 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 133 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

    return ListSource(
        data=[
            {"val1": "first", "val2": 111},
            {"val1": "second", "val2": 222},
            {"val1": "third", "val2": 333},
        ],
        accessors=["val1", "val2"],
    )

=====================================================================
Found a 10 line (46 tokens) duplication in the following files: 
Starting at line 186 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 208 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    child1 = ExampleLeafWidget(id="child1_id")
    child2 = ExampleLeafWidget(id="child2_id")
    child3 = ExampleLeafWidget(id="child3_id")

    # Add only two children to widget
    widget.add(child1)
    widget.add(child2)

    # Verify children have been added
    assert widget.children == [child1, child2]

=====================================================================
Found a 17 line (46 tokens) duplication in the following files: 
Starting at line 151 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py
Starting at line 424 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 199 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

def test_on_change(widget):
    """The on_change handler can be invoked."""
    # No handler initially
    assert widget._on_change._raw is None

    # Define and set a new callback
    handler = Mock()

    widget.on_change = handler

    assert widget.on_change._raw == handler

    # Invoke the callback
    widget._impl.simulate_change()

    # Callback was invoked
    handler.assert_called_once_with(widget)

=====================================================================
Found a 8 line (46 tokens) duplication in the following files: 
Starting at line 22 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_selection.py
Starting at line 168 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_selection.py

    return ListSource(
        accessors=["key", "value"],
        data=[
            {"key": "first", "value": 111},
            {"key": "second", "value": 222},
            {"key": "third", "value": 333},
        ],
    )

=====================================================================
Found a 13 line (46 tokens) duplication in the following files: 
Starting at line 45 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 14 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py

    assert window._impl.interface == window
    assert_action_performed(window, "create MainWindow")

    # This is a secondary main window; app menus have not been created, but
    # window menus and toolbars have been.
    assert_action_not_performed(window, "create App menus")
    assert_action_performed(window, "create Window menus")
    assert_action_performed(window, "create toolbar")

    # We can't know what the ID is, but it must be a string.
    assert isinstance(window.id, str)
    # Window title is the document title.
    assert window.title == "Example Document: Untitled"

=====================================================================
Found a 15 line (46 tokens) duplication in the following files: 
Starting at line 726 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 774 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 823 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 871 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 923 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 971 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 1021 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

            "The error",
            on_result=on_result_handler,
        )

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is None

=====================================================================
Found a 9 line (45 tokens) duplication in the following files: 
Starting at line 36 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 139 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py

    app.documents.open(document_path)

    await app_probe.redraw("Document has been opened", delay=0.1)

    assert len(app.documents) == 1
    assert len(app.windows) == 2

    # Document has been read.
    app.documents[0]._content.read.assert_called_with(document_path)

=====================================================================
Found a 17 line (45 tokens) duplication in the following files: 
Starting at line 2 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_dateinput.py
Starting at line 2 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_timeinput.py

from unittest.mock import Mock, call

from pytest import fixture

import toga

from ..conftest import skip_on_platforms
from .conftest import build_cleanup_test
from .properties import (  # noqa: F401
    test_background_color,
    test_background_color_reset,
    test_background_color_transparent,
    test_color,
    test_color_reset,
    test_enabled,
    test_flex_horizontal_widget_size,
)

=====================================================================
Found a 6 line (45 tokens) duplication in the following files: 
Starting at line 97 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 107 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(200, abs=2)
    assert probe.height == pytest.approx(container_probe.height, abs=2)
    assert probe.preserve_aspect_ratio
    # Container has fixed width; aspect ratio is preserved, so image isn't tall
    probe.assert_image_size(200, 100)

=====================================================================
Found a 6 line (45 tokens) duplication in the following files: 
Starting at line 139 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 149 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    await probe.redraw("Image is in a row box")
    assert probe.width == pytest.approx(container_probe.width, abs=2)
    assert probe.height == pytest.approx(150, abs=2)
    assert probe.preserve_aspect_ratio
    # Container has fixed height; aspect ratio is preserved, so image isn't wide
    probe.assert_image_size(300, 150)

=====================================================================
Found a 7 line (45 tokens) duplication in the following files: 
Starting at line 229 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 250 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 260 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 280 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expanding/collapsing nodes when tree is not expanded
    # Expand a single root node
    widget.expand(source[1])

=====================================================================
Found a 8 line (45 tokens) duplication in the following files: 
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_widget_registry.py
Starting at line 12 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    return WidgetRegistry()


# Create the simplest possible widget with a concrete implementation
class ExampleWidget(toga.Widget):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._impl = self.factory.Widget(self)

=====================================================================
Found a 9 line (45 tokens) duplication in the following files: 
Starting at line 74 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 114 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 160 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 214 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py

    if change_handler:
        statusiconset.commands.on_change = change_handler

    status_1 = SimpleStatusIcon(id="s1")
    status_2 = SimpleStatusIcon(id="s2")
    status_3 = SimpleStatusIcon(id="s3")
    statusiconset.add(status_1, status_2, status_3)

    assert len(statusiconset) == 3

=====================================================================
Found a 17 line (45 tokens) duplication in the following files: 
Starting at line 405 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 535 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    window = toga.Window()
    window.content = widget
    # Clear the event log
    EventLog.reset()

    # Widget has an app and window
    assert widget.app == app
    assert widget.window == window

    # Child list is empty
    assert widget.children == []

    # Create a child widget
    child = ExampleLeafWidget(id="child_id")

    # App's widget index only contains the parent
    assert app.widgets["widget_id"] == widget

=====================================================================
Found a 8 line (45 tokens) duplication in the following files: 
Starting at line 107 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 71 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py
Starting at line 61 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

    assert_action_performed(window, "create toolbar")

    assert window.id == "my-window"
    assert window.title == "My Window"
    assert window.position == toga.Position(10, 20)
    assert window.size == toga.Size(200, 300)
    assert not window.resizable
    assert window.closable

=====================================================================
Found a 12 line (44 tokens) duplication in the following files: 
Starting at line 245 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 268 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

        and window1_widget_probe.height > initial_window1_widget_size[1]
    )

    assert not app_probe.is_full_screen(window2)
    assert app_probe.content_size(window2) == initial_content2_size
    assert (
        window2_widget_probe.width == initial_window2_widget_size[0]
        and window2_widget_probe.height == initial_window2_widget_size[1]
    )

    # Exit full screen
    app.exit_full_screen()

=====================================================================
Found a 6 line (44 tokens) duplication in the following files: 
Starting at line 163 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 183 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 193 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    await probe.redraw("Image has explicit sizing")
    assert probe.width == pytest.approx(200, abs=2)
    assert probe.height == pytest.approx(300, abs=2)
    assert not probe.preserve_aspect_ratio
    # Image is the size specified.
    probe.assert_image_size(200, 300)

=====================================================================
Found a 18 line (44 tokens) duplication in the following files: 
Starting at line 135 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_scrollcontainer.py
Starting at line 203 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_scrollcontainer.py

    content.insert(
        0,
        toga.Label(
            "This is a long label",
            style=Pack(
                width=2000,
                background_color=CORNFLOWERBLUE,
                padding=20,
                height=20,
            ),
        ),
    )

    # clear any scroll events caused by setup
    on_scroll.reset_mock()

    # Disable horizontal scrolling
    widget.horizontal = False

=====================================================================
Found a 19 line (44 tokens) duplication in the following files: 
Starting at line 215 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 473 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    on_activate_handler.assert_called_once_with(widget, row=source[1])
    on_activate_handler.reset_mock()


async def test_multiselect(
    multiselect_widget,
    multiselect_probe,
    source,
    on_select_handler,
):
    """A table can be set up for multi-select"""
    await multiselect_probe.redraw("No row is selected in multiselect table")

    # Initial selection is empty
    assert multiselect_widget.selection == []
    on_select_handler.assert_not_called()

    # A single row can be selected
    await multiselect_probe.select_row(1)

=====================================================================
Found a 11 line (44 tokens) duplication in the following files: 
Starting at line 185 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py
Starting at line 448 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py

        second_window.close()
        await second_window_probe.wait_for_window("Secondary window has been closed")

        assert second_window not in app.windows

    @pytest.mark.parametrize(
        "second_window_class, second_window_kwargs",
        [
            (
                toga.Window,
                dict(title="Secondary Window", position=(200, 300), size=(300, 200)),

=====================================================================
Found a 7 line (44 tokens) duplication in the following files: 
Starting at line 569 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 799 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1

=====================================================================
Found a 5 line (44 tokens) duplication in the following files: 
Starting at line 591 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 625 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 691 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1
    example_doc = doc_app.documents[0]
    assert example_doc.path == example_file
    orig_position = doc_app.documents[0].main_window.position

=====================================================================
Found a 7 line (44 tokens) duplication in the following files: 
Starting at line 600 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 634 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 698 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 772 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1

=====================================================================
Found a 11 line (44 tokens) duplication in the following files: 
Starting at line 721 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 739 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 772 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [None]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # No second window was opened
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

    # The replace attribute has been removed.
    assert not hasattr(doc_app.documents[0].main_window, "_replace")

=====================================================================
Found a 4 line (44 tokens) duplication in the following files: 
Starting at line 13 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_widget_registry.py
Starting at line 12 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/test_applicator.py
Starting at line 17 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 7 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

class ExampleWidget(toga.Widget):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._impl = self.factory.Widget(self)

=====================================================================
Found a 11 line (44 tokens) duplication in the following files: 
Starting at line 259 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 276 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

    row = source.insert(1, dict(val1="new element", val2=999))

    assert len(source) == 4
    assert source[1] == row
    assert row.val1 == "new element"
    assert row.val2 == 999

    listener.insert.assert_called_once_with(index=1, item=row)


def test_insert_positional(source):

=====================================================================
Found a 11 line (44 tokens) duplication in the following files: 
Starting at line 293 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 310 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

    row = source.append(dict(val1="new element", val2=999))

    assert len(source) == 4
    assert source[3] == row
    assert row.val1 == "new element"
    assert row.val2 == 999

    listener.insert.assert_called_once_with(index=3, item=row)


def test_append_positional(source):

=====================================================================
Found a 10 line (44 tokens) duplication in the following files: 
Starting at line 243 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 436 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

@pytest.mark.parametrize(
    "index, actual_index",
    [
        (1, 1),  # Positive, in range
        (10, 2),  # Positive, past positive limit
        (-1, 1),  # Negative, in range
        (-10, 0),  # Negative, past negative limit
    ],
)
def test_insert(source, node, index, actual_index):

=====================================================================
Found a 7 line (44 tokens) duplication in the following files: 
Starting at line 38 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_beeliza.py
Starting at line 36 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_tutorial3.py

        (160, 125),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {"origin": (0, 0), "content": (640, 455)},

=====================================================================
Found a 9 line (44 tokens) duplication in the following files: 
Starting at line 43 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 103 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 165 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 222 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 190 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 255 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

        (200, 100),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),

=====================================================================
Found a 9 line (44 tokens) duplication in the following files: 
Starting at line 76 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py
Starting at line 102 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py
Starting at line 128 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py
Starting at line 154 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py

            ExampleNode("space_filler", style=Pack(width=30, height=100)),
            ExampleNode("widget", style=Pack(width=30, height=30)),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (60, 100),

=====================================================================
Found a 11 line (44 tokens) duplication in the following files: 
Starting at line 28 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 44 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    cleanup = Mock()

    wrapped = wrapped_handler(obj, None, cleanup=cleanup)

    assert wrapped._raw is None

    # This does nothing, but doesn't raise an error, and returns None
    assert wrapped("arg1", "arg2", kwarg1=3, kwarg2=4) is None

    # Cleanup method was invoked
    cleanup.assert_called_once_with(obj, None)

=====================================================================
Found a 14 line (44 tokens) duplication in the following files: 
Starting at line 63 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 61 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_timeinput.py

        (None, date(2023, 5, 25)),
    ],
)
def test_value(widget, value, expected, on_change_handler):
    """The value of the datepicker can be set."""
    widget.value = value

    assert widget.value == expected

    on_change_handler.assert_called_once_with(widget)


INVALID_VALUES = [
    (123, TypeError, "Not a valid date value"),

=====================================================================
Found a 11 line (44 tokens) duplication in the following files: 
Starting at line 46 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py
Starting at line 107 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_multilinetextinput.py

@pytest.mark.parametrize(
    "value, expected",
    [
        ("New Text", "New Text"),
        ("", ""),
        (None, ""),
        (12345, "12345"),
        ("Contains\nnewline", "Contains\nnewline"),
    ],
)
def test_value(widget, value, expected):

=====================================================================
Found a 8 line (44 tokens) duplication in the following files: 
Starting at line 196 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 222 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py

    monkeypatch.setattr(app.documents, "_types", ExampleDocument)
    doc = ExampleDocument(app)
    doc.touch()
    assert doc.modified

    window = doc.main_window
    # Prime the user's responses to the dialogs
    window._impl.dialog_responses["QuestionDialog"] = [True]

=====================================================================
Found a 4 line (43 tokens) duplication in the following files: 
Starting at line 115 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 122 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 129 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 138 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 145 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py

    await probe.redraw("Child should not in layout yet")
    probe.assert_layout(position=(0, 0), size=(100, 200))
    other_probe.assert_layout(position=(100, 0), size=(100, 200))
    child_probe.assert_not_contained()

=====================================================================
Found a 10 line (43 tokens) duplication in the following files: 
Starting at line 56 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 144 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    )

    # Make the parent a flex column
    # Image will try to be as tall as the container, but will be
    # constrained by preserving the aspect ratio
    widget.parent.style.direction = COLUMN

    await probe.redraw("Image is in a column box")
    assert probe.width == pytest.approx(container_probe.width, abs=2)
    assert probe.height == pytest.approx(container_probe.height, abs=2)

=====================================================================
Found a 13 line (43 tokens) duplication in the following files: 
Starting at line 316 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_scrollcontainer.py
Starting at line 388 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_scrollcontainer.py

    await probe.redraw("Content has been switched for a small document")

    assert probe.document_width == probe.width
    assert probe.document_height == probe.height

    assert widget.max_horizontal_position == 0
    assert widget.max_vertical_position == 0

    assert widget.horizontal_position == 0
    assert widget.vertical_position == 0

    # This doesn't change the position, so whether it calls on_scroll is undefined.
    widget.vertical_position = probe.height * 3

=====================================================================
Found a 4 line (43 tokens) duplication in the following files: 
Starting at line 96 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py
Starting at line 482 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py

            box1 = toga.Box(
                style=Pack(background_color=REBECCAPURPLE, width=10, height=10)
            )
            box2 = toga.Box(style=Pack(background_color=GOLDENROD, width=10, height=20))

=====================================================================
Found a 13 line (43 tokens) duplication in the following files: 
Starting at line 767 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_app.py
Starting at line 787 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_app.py

        def on_running(self):
            running["called"] = True

    app = SubclassedApp(formal_name="Test App", app_id="org.example.test")

    # Run a fake main loop.
    app.loop.run_until_complete(asyncio.sleep(0.5))

    # The running method was invoked
    assert running["called"]


def test_async_running_method(event_loop):

=====================================================================
Found a 8 line (43 tokens) duplication in the following files: 
Starting at line 569 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 600 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 634 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 669 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 721 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 739 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    doc_app._impl.dialog_responses["OpenFileDialog"] = [other_file]

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

=====================================================================
Found a 10 line (43 tokens) duplication in the following files: 
Starting at line 835 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 951 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    current_window = doc_app.current_window
    first_doc = current_window.doc
    assert first_doc.path == example_file

    # Open a readonly document, set to be current
    second_doc = doc_app.documents.open(other_file)
    doc_app.current_window = second_doc.main_window

    # Activate the save menu
    future = doc_app.commands[toga.Command.SAVE].action()

=====================================================================
Found a 6 line (43 tokens) duplication in the following files: 
Starting at line 31 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 75 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 133 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    app.commands.clear()

    # Put some commands into the app
    cmd_a = toga.Command(None, text="App command a")
    cmd_b = toga.Command(None, text="App command b", order=10)
    app.commands.add(cmd_a, cmd_b)

=====================================================================
Found a 12 line (43 tokens) duplication in the following files: 
Starting at line 273 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 319 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    cs.discard(cmd_a)

    # The discarded command is no longer in the command set.
    assert "custom-command-a" not in cs
    assert cmd_a not in cs
    # Change handler was invoked
    if change_handler:
        change_handler.assert_called_once_with()


@pytest.mark.parametrize("change_handler", [(None), (Mock())])
def test_discard_missing(change_handler):

=====================================================================
Found a 8 line (43 tokens) duplication in the following files: 
Starting at line 91 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 124 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 157 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

    assert len(source) == 3
    assert source[1].val1 == "new element"
    assert source[1].val2 == 999

    listener.insert.assert_called_once_with(index=1, item=source[1])


def test_list():

=====================================================================
Found a 9 line (43 tokens) duplication in the following files: 
Starting at line 20 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_beeliza.py
Starting at line 15 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_tutorial3.py

                style=Pack(direction=ROW),
                children=[
                    ExampleNode(
                        "input",
                        style=Pack(flex=1, padding=5),
                        size=(at_least(100), 15),
                    ),
                    ExampleNode(
                        "button", style=Pack(padding=5), size=(at_least(40), 10)

=====================================================================
Found a 10 line (43 tokens) duplication in the following files: 
Starting at line 584 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 607 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        return 42

    wrapped = simple_handler(handler, "arg1", "arg2", kwarg1=3, kwarg2=4)

    # Invoke the handler as if it were a method handler (i.e., with the extra "widget"
    # argument)
    assert wrapped("obj") == 42

=====================================================================
Found a 9 line (43 tokens) duplication in the following files: 
Starting at line 204 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_icons.py
Starting at line 228 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_icons.py

    monkeypatch.setattr(sys, "executable", "/path/to/App")

    # Load the app default icon
    icon = toga.Icon(_APP_ICON)

    assert isinstance(icon, toga.Icon)
    # App icon path reports as `resources/<app_name>`; impl is the app icon
    assert icon.path == Path("resources/icons")
    assert icon._impl.path == "<APP ICON>"

=====================================================================
Found a 10 line (43 tokens) duplication in the following files: 
Starting at line 675 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 685 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 785 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

            "push context",
            {
                "fill_color": rgb(255, 0, 0),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        (

=====================================================================
Found a 10 line (43 tokens) duplication in the following files: 
Starting at line 708 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 718 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 751 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

            "push context",
            {
                "fill_color": rgb(0, 0, 255),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        (

=====================================================================
Found a 15 line (43 tokens) duplication in the following files: 
Starting at line 67 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 355 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 649 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    leaf = ExampleLeafWidget()

    # Widget doesn't have an app or window
    assert leaf.app is None
    assert leaf.window is None

    # Leaf nodes report an empty child list
    assert leaf.children == []

    # Create a child widget
    child = ExampleLeafWidget()

    # Add the child.
    with pytest.raises(ValueError, match=r"ExampleLeafWidget cannot have children"):
        leaf.add(child)

=====================================================================
Found a 4 line (43 tokens) duplication in the following files: 
Starting at line 71 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py
Starting at line 111 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

    assert sorted(app.widgets.items()) == [
        ("1.0", win_1.content),
        ("1.1", win_1.content.children[0]),
        ("1.2", win_1.content.children[1]),

=====================================================================
Found a 9 line (42 tokens) duplication in the following files: 
Starting at line 245 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 292 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 315 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

        and window1_widget_probe.height > initial_window1_widget_size[1]
    )

    assert not app_probe.is_full_screen(window2)
    assert app_probe.content_size(window2) == initial_content2_size
    assert (
        window2_widget_probe.width == initial_window2_widget_size[0]
        and window2_widget_probe.height == initial_window2_widget_size[1]
    )

=====================================================================
Found a 11 line (42 tokens) duplication in the following files: 
Starting at line 429 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 783 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

class MyIconData:
    def __init__(self, text, icon):
        self.text = text
        self.icon = icon

    def __str__(self):
        return f"<icondata {self.text}>"


async def test_cell_icon(widget, probe):
    "An icon can be used as a cell value"

=====================================================================
Found a 6 line (42 tokens) duplication in the following files: 
Starting at line 571 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 602 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 636 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 671 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 723 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 741 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 758 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 774 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    future = doc_app.commands[toga.Command.OPEN].action()
    doc_app.loop.run_until_complete(future)

    # There is still only 1 document, and 1 window
    assert len(doc_app.documents) == 1
    assert len(doc_app.windows) == 1

=====================================================================
Found a 4 line (42 tokens) duplication in the following files: 
Starting at line 13 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_widget_registry.py
Starting at line 12 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/test_applicator.py
Starting at line 21 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/test_applicator.py
Starting at line 17 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 26 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 7 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

class ExampleWidget(toga.Widget):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self._impl = self.factory.Widget(self)

=====================================================================
Found a 10 line (42 tokens) duplication in the following files: 
Starting at line 278 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 359 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py

        {"val1": "new"},
        children=[
            ({"val1": "new child 1"}, None),
            ({"val1": "new child 2"}, None),
        ],
    )

    # Node has one more child.
    assert len(node) == 3
    assert node[1] == new_child

=====================================================================
Found a 10 line (42 tokens) duplication in the following files: 
Starting at line 468 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py
Starting at line 519 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

        {"val1": "new"},
        children=[
            ({"val1": "new child 1"}, None),
            ({"val1": "new child 2"}, None),
        ],
    )

    # Source has one more root.
    assert len(source) == 3
    assert source[1] == new_child

=====================================================================
Found a 7 line (42 tokens) duplication in the following files: 
Starting at line 38 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_beeliza.py
Starting at line 357 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 633 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 36 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_tutorial3.py

        (160, 125),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {"origin": (0, 0), "content": (640, 455)},

=====================================================================
Found a 12 line (42 tokens) duplication in the following files: 
Starting at line 189 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 22 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 68 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py
Starting at line 114 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py

                            width=100, height=36, padding_top=38, padding_bottom=40
                        ),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (430, 310),

=====================================================================
Found a 9 line (42 tokens) duplication in the following files: 
Starting at line 43 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 103 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 190 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 255 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 308 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

        (200, 100),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),

=====================================================================
Found a 9 line (42 tokens) duplication in the following files: 
Starting at line 43 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 103 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 165 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 222 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 190 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 255 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 513 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 136 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py

        (200, 100),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {
                    "origin": (0, 0),
                    "content": (100, 100),

=====================================================================
Found a 7 line (42 tokens) duplication in the following files: 
Starting at line 149 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 289 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    cleanup = Mock(side_effect=Exception("Problem in cleanup"))
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs

=====================================================================
Found a 14 line (42 tokens) duplication in the following files: 
Starting at line 222 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 287 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

            {},
            "x=None, y=None, color=rgb(0, 0, 0), line_width=2.0, line_dash=None",
            False,
            {
                "x": None,
                "y": None,
                "color": rgb(0, 0, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        # X only
        (
            {"x": 10},

=====================================================================
Found a 10 line (42 tokens) duplication in the following files: 
Starting at line 665 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 799 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

                "y": 30,
                "fill_color": rgb(255, 0, 0),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        # begin fill 2
        (

=====================================================================
Found a 10 line (42 tokens) duplication in the following files: 
Starting at line 698 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 742 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 765 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

                "y": 200,
                "fill_color": rgb(0, 0, 255),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        # stroke 2
        (

=====================================================================
Found a 12 line (42 tokens) duplication in the following files: 
Starting at line 244 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 280 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py

        (content2 if include_left else None, 2),
        (content3 if include_right else None, 3),
    ]

    assert_action_performed_with(
        splitcontainer,
        "set content",
        content=[
            content2._impl if include_left else None,
            content3._impl if include_right else None,
        ],
        flex=[2, 3],

=====================================================================
Found a 12 line (42 tokens) duplication in the following files: 
Starting at line 174 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py
Starting at line 186 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

    second = ExampleWidget(id="magic")

    assert "magic" in app.widgets
    assert "magic" in win_1.widgets
    assert "magic" not in win_2.widgets
    assert app.widgets["magic"] == first

    # The second widget can't be added as content to either window, because of the ID clash.
    with pytest.raises(
        KeyError,
        match=r"There is already a widget with the id 'magic'",
    ):

=====================================================================
Found a 11 line (41 tokens) duplication in the following files: 
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/src/testbed/app.py
Starting at line 31 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/src/testbed/app.py

    extensions = ["testbed", "tbed"]

    def create(self):
        # Create the main window for the document.
        self.main_window = toga.DocumentWindow(
            doc=self,
            content=toga.Box(),
        )
        self._content = Mock()

    def read(self):

=====================================================================
Found a 10 line (41 tokens) duplication in the following files: 
Starting at line 215 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 262 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 309 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

    assert app.is_full_screen

    assert not app_probe.is_full_screen(window1)
    assert app_probe.content_size(window1) == initial_content1_size
    assert (
        window1_widget_probe.width == initial_window1_widget_size[0]
        and window1_widget_probe.height == initial_window1_widget_size[1]
    )

    assert app_probe.is_full_screen(window2)

=====================================================================
Found a 8 line (41 tokens) duplication in the following files: 
Starting at line 102 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 188 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    probe.assert_image_size(200, 100)

    # Make the parent a flex column
    widget.parent.style.direction = COLUMN

    await probe.redraw("Image is in a column box")
    assert probe.width == pytest.approx(200, abs=2)
    assert probe.height == pytest.approx(container_probe.height, abs=2)

=====================================================================
Found a 18 line (41 tokens) duplication in the following files: 
Starting at line 5 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_passwordinput.py
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_textinput.py

from .conftest import build_cleanup_test
from .properties import (  # noqa: F401
    test_alignment,
    test_background_color,
    test_background_color_reset,
    test_background_color_transparent,
    test_color,
    test_color_reset,
    test_enabled,
    test_flex_horizontal_widget_size,
    test_focus,
    test_font,
    test_font_attrs,
    test_placeholder,
    test_placeholder_color,
    test_placeholder_focus,
    test_readonly,
)

=====================================================================
Found a 14 line (41 tokens) duplication in the following files: 
Starting at line 29 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 14 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

@pytest.fixture
def on_select_handler():
    return Mock()


@pytest.fixture
def on_activate_handler():
    return Mock()


@pytest.fixture
def source():
    return ListSource(
        accessors=["a", "b", "c", "d", "e"],

=====================================================================
Found a 6 line (41 tokens) duplication in the following files: 
Starting at line 240 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 250 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 260 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 280 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 310 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expand a single root node again
    widget.expand(source[1])

=====================================================================
Found a 6 line (41 tokens) duplication in the following files: 
Starting at line 270 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 300 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 440 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Attempt to collapse a leaf node
    widget.collapse(source[1][2][1])

=====================================================================
Found a 6 line (41 tokens) duplication in the following files: 
Starting at line 580 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 593 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 657 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 670 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    probe.assert_cell_content((0, 2), 0, "AY")
    probe.assert_cell_content((0, 5), 0, "A4")
    probe.assert_cell_content((0, 6), 0, "AX")

    # Missing value has been populated
    probe.assert_cell_content((0, 2), 1, "MISSING!")

=====================================================================
Found a 9 line (41 tokens) duplication in the following files: 
Starting at line 199 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py
Starting at line 199 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py

    app._impl.dialog_responses["OpenFileDialog"] = [opened_files]

    dialog = toga.OpenFileDialog(
        "Title",
        file_types=[".txt", ".pdf"],
        multiple_select=True,
    )

    assert app._impl.loop.run_until_complete(app.dialog(dialog)) is opened_files

=====================================================================
Found a 7 line (41 tokens) duplication in the following files: 
Starting at line 149 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 251 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 366 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert toga.Command.OPEN in app.commands
    assert toga.Command.SAVE in app.commands
    assert toga.Command.SAVE_AS in app.commands
    assert toga.Command.SAVE_ALL in app.commands


def test_create_no_cmdline_default_handling_close_on_last_window(monkeypatch):

=====================================================================
Found a 13 line (41 tokens) duplication in the following files: 
Starting at line 867 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 983 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    future = doc_app.commands[toga.Command.SAVE].action()
    doc_app.loop.run_until_complete(future)

    # The second document is the one we saved
    first_doc._mock_write.assert_not_called()
    second_doc._mock_write.assert_called_once_with(path)

    # Second document has had properties updated
    assert second_doc.path == path
    assert second_doc.title == "Example Document: filename2"


def test_save_menu_untitled_cancel(doc_app, example_file, tmp_path):

=====================================================================
Found a 8 line (41 tokens) duplication in the following files: 
Starting at line 934 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 980 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    first_doc.main_window._impl.dialog_responses["SaveFileDialog"] = [path]

    # Activate the Save As menu
    future = doc_app.commands[toga.Command.SAVE_AS].action()
    doc_app.loop.run_until_complete(future)

    # The first document is the one we saved
    first_doc._mock_write.assert_called_once_with(path)

=====================================================================
Found a 10 line (41 tokens) duplication in the following files: 
Starting at line 121 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_group.py
Starting at line 205 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_group.py

    assert not group_c.is_parent_of(group_a)

    assert group_a.parent is None
    assert group_a.root == group_a

    assert group_b.parent == group_a
    assert group_b.root == group_a

    assert group_c.parent == group_b
    assert group_c.root == group_a

=====================================================================
Found a 9 line (41 tokens) duplication in the following files: 
Starting at line 666 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 677 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 687 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 787 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 800 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

                "fill_color": rgb(255, 0, 0),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        # begin fill 2
        (

=====================================================================
Found a 9 line (41 tokens) duplication in the following files: 
Starting at line 699 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 710 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 720 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 743 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 753 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 766 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

                "fill_color": rgb(0, 0, 255),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        # stroke 2
        (

=====================================================================
Found a 6 line (41 tokens) duplication in the following files: 
Starting at line 744 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 803 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 1086 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    child1 = ExampleLeafWidget(id="child1_id")
    child2 = ExampleLeafWidget(id="child2_id")
    child3 = ExampleLeafWidget(id="child3_id")
    widget.add(child1, child2, child3)

    window = toga.Window()

=====================================================================
Found a 11 line (41 tokens) duplication in the following files: 
Starting at line 194 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 182 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_timeinput.py

        ("2023-03-11", date(2023, 3, 11)),
    ],
)
def test_max(widget, value, expected):
    """The max of the datepicker can be set."""
    widget.max = value

    assert widget.max == expected


@pytest.mark.parametrize("value, exc, message", INVALID_LIMITS)

=====================================================================
Found a 13 line (41 tokens) duplication in the following files: 
Starting at line 559 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 682 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 776 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 825 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 873 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 925 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 973 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 1023 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        dialog = window.info_dialog("Title", "Body", on_result=on_result_handler)

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog) is None

=====================================================================
Found a 10 line (40 tokens) duplication in the following files: 
Starting at line 73 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_dialogs.py
Starting at line 112 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_dialogs.py

    stack = io.StringIO()
    traceback.print_stack(file=stack)

    dialog = toga.StackTraceDialog(
        "Stack Trace",
        "Some stack trace",
        stack.getvalue(),
        retry=result is not None,
    )
    assert app_probe.is_modal_dialog(dialog)

=====================================================================
Found a 3 line (40 tokens) duplication in the following files: 
Starting at line 47 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/test_images.py
Starting at line 64 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/test_images.py

    pil_image = PIL_Image.new("RGBA", size=(110, 30))
    draw_context = PIL_ImageDraw.Draw(pil_image)
    draw_context.text((20, 10), "Hello World", fill="green")

=====================================================================
Found a 2 line (40 tokens) duplication in the following files: 
Starting at line 37 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 49 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 60 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 116 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 123 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 130 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 139 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py
Starting at line 146 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_base.py

    probe.assert_layout(position=(0, 0), size=(100, 200))
    other_probe.assert_layout(position=(100, 0), size=(100, 200))

=====================================================================
Found a 4 line (40 tokens) duplication in the following files: 
Starting at line 554 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py
Starting at line 570 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py

    with canvas.context.ClosedPath(x=20, y=20) as path:
        path.line_to(x=100, y=20)
        path.line_to(x=180, y=180)
        path.line_to(x=100, y=180)

=====================================================================
Found a 11 line (40 tokens) duplication in the following files: 
Starting at line 484 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 839 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

        {
            # Normal text,
            "a": f"A{i}",
            "b": f"B{i}",
            # Toga widgets.
            "c": (
                toga.Button(f"C{i}")
                if i % 2 == 0
                else toga.TextInput(value=f"edit C{i}")
            ),
        }

=====================================================================
Found a 15 line (40 tokens) duplication in the following files: 
Starting at line 54 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 113 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    assert list(app.commands) == [cmd_a, cmd_b]

    # Clear the command set
    cs.clear()

    # Change handler was called once.
    if change_handler:
        change_handler.assert_called_once()
        change_handler.reset_mock()

    # Command set no commands.
    assert list(cs) == []

    # App command set hasn't changed.
    assert list(app.commands) == [cmd_a, cmd_b]

=====================================================================
Found a 9 line (40 tokens) duplication in the following files: 
Starting at line 229 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 276 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 322 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    assert "custom-command-a" not in cs
    assert cmd_a not in cs
    # Change handler was invoked
    if change_handler:
        change_handler.assert_called_once_with()


@pytest.mark.parametrize("change_handler", [(None), (Mock())])
def test_delitem_missing(change_handler):

=====================================================================
Found a 11 line (40 tokens) duplication in the following files: 
Starting at line 276 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 466 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

    new_child = node.insert(
        1,
        {"val1": "new"},
        children=[
            ({"val1": "new child 1"}, None),
            ({"val1": "new child 2"}, None),
        ],
    )

    # Node has one more child.
    assert len(node) == 3

=====================================================================
Found a 7 line (40 tokens) duplication in the following files: 
Starting at line 38 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_beeliza.py
Starting at line 43 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 103 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 165 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 222 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 35 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 190 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 255 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 308 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 357 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 513 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 633 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 136 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_rtl.py
Starting at line 36 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_tutorial3.py

        (160, 125),
        (640, 480),
        {
            "origin": (0, 0),
            "content": (640, 480),
            "children": [
                {"origin": (0, 0), "content": (640, 455)},

=====================================================================
Found a 13 line (40 tokens) duplication in the following files: 
Starting at line 100 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 145 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

            {},
            "x=None, y=None, color=rgb(0, 0, 0), fill_rule=FillRule.NONZERO",
            False,
            {
                "x": None,
                "y": None,
                "color": rgb(0, 0, 0),
                "fill_rule": FillRule.NONZERO,
            },
        ),
        # X only
        (
            {"x": 10},

=====================================================================
Found a 9 line (40 tokens) duplication in the following files: 
Starting at line 396 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 414 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 468 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py

                "rotation": 0.0,
                "startangle": 0.0,
                "endangle": pytest.approx(6.283185),
                "anticlockwise": False,
            },
        ),
        # Rotation
        (
            {"x": 10, "y": 20, "radiusx": 30, "radiusy": 40, "rotation": 1.234},

=====================================================================
Found a 7 line (40 tokens) duplication in the following files: 
Starting at line 116 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_mapview.py
Starting at line 137 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_mapview.py

    assert_action_not_performed(widget, "update pin")

    # Pin Location can be changed with a LatLng
    pin.location = toga.LatLng(12.34, 56.78)
    assert isinstance(pin.location, toga.LatLng)
    assert pin.location == (12.34, 56.78)
    assert_action_not_performed(widget, "update pin")

=====================================================================
Found a 9 line (40 tokens) duplication in the following files: 
Starting at line 68 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 204 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 273 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py

        (123, Decimal("123")),
        # Float and integer specified as string
        ("1.23", Decimal("1.23")),
        ("123", Decimal("123")),
        ("1.23e+4", Decimal("1.23e+4")),
        # Excessive precision is rounded to same number of decimal places as step
        # (see QUANTIZE_PARAMS for related tests).
        ("1.23456", Decimal("1.23")),
        ("1.235", Decimal("1.24")),

=====================================================================
Found a 7 line (40 tokens) duplication in the following files: 
Starting at line 49 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py
Starting at line 90 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

    table = toga.Table(["First", "Second"])
    assert table._impl.interface == table
    assert_action_performed(table, "create Table")

    assert len(table.data) == 0
    assert table.headings == ["First", "Second"]
    assert table.accessors == ["first", "second"]

=====================================================================
Found a 9 line (40 tokens) duplication in the following files: 
Starting at line 146 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 171 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py

    mock_path = Mock()
    doc = ExampleDocument(app)
    doc._path = mock_path
    doc.touch()
    assert doc.modified

    window = doc.main_window
    # Prime the user's responses to the dialogs
    window._impl.dialog_responses["QuestionDialog"] = [True]

=====================================================================
Found a 13 line (40 tokens) duplication in the following files: 
Starting at line 600 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 641 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 728 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 776 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 825 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 873 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 925 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 973 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 1023 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        dialog = window.question_dialog("Title", "Body", on_result=on_result_handler)

    assert dialog.window == window
    assert dialog.app == app

    with pytest.raises(
        RuntimeError,
        match=r"Can't check dialog result directly; use await or an on_result handler",
    ):
        # Perform a synchronous comparison; this will raise a runtime error
        dialog == 1

    assert app._impl.loop.run_until_complete(dialog)

=====================================================================
Found a 11 line (39 tokens) duplication in the following files: 
Starting at line 53 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 105 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    return toga.Table(
        ["A", "B", "C"],
        data=source,
        missing_value="MISSING!",
        on_select=on_select_handler,
        on_activate=on_activate_handler,
        style=Pack(flex=1),
    )


@pytest.fixture

=====================================================================
Found a 7 line (39 tokens) duplication in the following files: 
Starting at line 229 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 270 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 290 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 310 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expanding/collapsing nodes when tree is not expanded
    # Expand a single root node
    widget.expand(source[1])

=====================================================================
Found a 6 line (39 tokens) duplication in the following files: 
Starting at line 240 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 250 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 260 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 280 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 300 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 440 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

    # Expand a single root node again
    widget.expand(source[1])

=====================================================================
Found a 7 line (39 tokens) duplication in the following files: 
Starting at line 330 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 339 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[1][2])
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse a single root node
    widget.collapse(source[1])
    await probe.redraw("Root Node 1 has been collapsed")

=====================================================================
Found a 8 line (39 tokens) duplication in the following files: 
Starting at line 369 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 380 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[1])
    # State of source[1][2] is ambiguous
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Expand a single root node
    widget.expand(source[1])
    await probe.redraw("Root Node 1 has been expanded")

=====================================================================
Found a 9 line (39 tokens) duplication in the following files: 
Starting at line 144 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py
Starting at line 144 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py

    app._impl.dialog_responses["SaveFileDialog"] = [saved_file]

    dialog = toga.SaveFileDialog(
        "Title",
        "initial_file.txt",
        file_types=[".txt", ".pdf"],
    )

    assert app._impl.loop.run_until_complete(app.dialog(dialog)) is saved_file

=====================================================================
Found a 9 line (39 tokens) duplication in the following files: 
Starting at line 893 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 915 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    future = doc_app.commands[toga.Command.SAVE].action()
    doc_app.loop.run_until_complete(future)

    # Neither document is saved.
    first_doc._mock_write.assert_not_called()
    second_doc._mock_write.assert_not_called()


def test_save_menu_non_document(doc_app, example_file):

=====================================================================
Found a 9 line (39 tokens) duplication in the following files: 
Starting at line 1008 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 1030 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    future = doc_app.commands[toga.Command.SAVE_AS].action()
    doc_app.loop.run_until_complete(future)

    # Neither document is saved.
    first_doc._mock_write.assert_not_called()
    second_doc._mock_write.assert_not_called()


def test_save_as_menu_non_document(doc_app, example_file):

=====================================================================
Found a 14 line (39 tokens) duplication in the following files: 
Starting at line 20 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 59 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

@pytest.mark.parametrize(
    "value",
    [
        None,
        42,
        "not a list",
    ],
)
def test_invalid_accessors(value):
    """Accessors for a list source must be a list of attribute names."""
    with pytest.raises(
        ValueError,
        match=r"accessors should be a list of attribute names",
    ):

=====================================================================
Found a 12 line (39 tokens) duplication in the following files: 
Starting at line 258 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 340 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py

    assert node[actual_index] == new_child

    # A child node was created using the source's factory
    source._create_node.assert_called_with(
        parent=node, data={"val1": "new"}, children=None
    )

    # insert notification was sent, the change is associated with the new item
    source.notify.assert_called_once_with(
        "insert",
        parent=node,
        index=actual_index,

=====================================================================
Found a 11 line (39 tokens) duplication in the following files: 
Starting at line 22 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 68 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 114 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_column_alignment.py
Starting at line 189 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_row_alignment.py

                        style=Pack(width=36, padding_left=38, padding_right=40),
                    ),
                ],
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (540, 300),

=====================================================================
Found a 9 line (39 tokens) duplication in the following files: 
Starting at line 65 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 121 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        return 42

    wrapped = wrapped_handler(obj, handler)

=====================================================================
Found a 7 line (39 tokens) duplication in the following files: 
Starting at line 332 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 362 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    async def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        await asyncio.sleep(0.01)  # A short sleep

=====================================================================
Found a 12 line (39 tokens) duplication in the following files: 
Starting at line 17 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/testbed/interactive.py
Starting at line 5 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/testbed/simple/app.py
Starting at line 9 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/testbed/subclassed/app.py

    app = SubclassedApp("Interactive App", "org.testbed.interactive-app")

    print(f"app.paths.app={app.paths.app.resolve()}")
    print(f"app.paths.config={app.paths.config.resolve()}")
    print(f"app.paths.data={app.paths.data.resolve()}")
    print(f"app.paths.cache={app.paths.cache.resolve()}")
    print(f"app.paths.logs={app.paths.logs.resolve()}")
    print(f"app.paths.toga={app.paths.toga.resolve()}")


if __name__ == "__main__":
    main()

=====================================================================
Found a 12 line (39 tokens) duplication in the following files: 
Starting at line 666 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 699 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

                "fill_color": rgb(255, 0, 0),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        # begin fill 2
        (
            "push context",
            {
                "fill_color": rgb(255, 0, 0),

=====================================================================
Found a 11 line (39 tokens) duplication in the following files: 
Starting at line 677 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 710 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

                "fill_color": rgb(255, 0, 0),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        (
            "begin path",
            {
                "fill_color": rgb(255, 0, 0),

=====================================================================
Found a 11 line (39 tokens) duplication in the following files: 
Starting at line 169 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 157 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_timeinput.py

    widget.max = date(2005, 12, 31)
    on_change_handler.reset_mock()

    widget.min = min
    assert widget.min == min

    if clip_value:
        assert widget.value == min
        on_change_handler.assert_called_once_with(widget)
    else:
        assert widget.value == date(2005, 6, 25)

=====================================================================
Found a 11 line (39 tokens) duplication in the following files: 
Starting at line 228 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 216 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_timeinput.py

    widget.value = date(2005, 12, 31)
    on_change_handler.reset_mock()

    widget.max = max
    assert widget.max == max

    if clip_value:
        assert widget.value == max
        on_change_handler.assert_called_once_with(widget)
    else:
        assert widget.value == date(2005, 12, 31)

=====================================================================
Found a 13 line (39 tokens) duplication in the following files: 
Starting at line 67 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 186 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 223 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 259 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py

    assert_action_performed(splitcontainer, "refresh")


@pytest.mark.parametrize(
    "include_left, include_right",
    [
        (False, False),
        (False, True),
        (True, False),
        (True, True),
    ],
)
def test_assign_to_app(app, content1, content2, include_left, include_right):

=====================================================================
Found a 5 line (38 tokens) duplication in the following files: 
Starting at line 122 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py
Starting at line 146 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py

    await probe.redraw("Canvas should be full size of window")
    assert on_resize_handler.call_count >= 1
    assert on_resize_handler.call_args.args == (widget,)
    assert on_resize_handler.call_args.kwargs["width"] > 300
    assert on_resize_handler.call_args.kwargs["height"] > 300

=====================================================================
Found a 5 line (38 tokens) duplication in the following files: 
Starting at line 130 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py
Starting at line 138 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_canvas.py

    await probe.redraw("Canvas should be tall and narrow")
    assert on_resize_handler.call_count >= 1
    assert on_resize_handler.call_args.args == (widget,)
    assert on_resize_handler.call_args.kwargs["width"] == 100
    assert on_resize_handler.call_args.kwargs["height"] > 300

=====================================================================
Found a 2 line (38 tokens) duplication in the following files: 
Starting at line 83 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_splitcontainer.py
Starting at line 173 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_splitcontainer.py

    assert content1_probe.width == pytest.approx(probe.width / 2, abs=20)
    assert content2_probe.width == pytest.approx(probe.width / 2, abs=20)

=====================================================================
Found a 10 line (38 tokens) duplication in the following files: 
Starting at line 358 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 518 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

    new_child = node.append(
        {"val1": "new"},
        children=[
            ({"val1": "new child 1"}, None),
            ({"val1": "new child 2"}, None),
        ],
    )

    # Node has one more child.
    assert len(node) == 3

=====================================================================
Found a 6 line (38 tokens) duplication in the following files: 
Starting at line 163 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 217 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 252 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py

    status_1 = SimpleStatusIcon(id="s1")
    status_2 = SimpleStatusIcon(id="s2")
    status_3 = SimpleStatusIcon(id="s3")
    statusiconset.add(status_1, status_2, status_3)

    assert list(statusiconset) == [status_1, status_2, status_3]

=====================================================================
Found a 10 line (38 tokens) duplication in the following files: 
Starting at line 62 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 142 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 223 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 384 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 465 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py
Starting at line 547 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_flex.py

        style=Pack(direction=ROW),
        children=[
            ExampleNode(
                "first",
                style=Pack(flex=1),
                size=(100, 100),
            ),
            ExampleNode(
                "second",
                style=Pack(direction=ROW, flex=1),

=====================================================================
Found a 7 line (38 tokens) duplication in the following files: 
Starting at line 362 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 398 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    async def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        await asyncio.sleep(0.01)  # A short sleep

=====================================================================
Found a 4 line (38 tokens) duplication in the following files: 
Starting at line 85 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 199 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 363 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert widget._impl.draw_instructions[1:-1] == [
        ("push context", {}),
        ("begin path", {}),
    ] + ([("move to", {"x": 10, "y": 20})] if has_move else []) + [

=====================================================================
Found a 7 line (38 tokens) duplication in the following files: 
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 641 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    context.insert(-1, fill)
    # Draw instructions show the new position
    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),

=====================================================================
Found a 10 line (38 tokens) duplication in the following files: 
Starting at line 390 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 462 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 480 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py

            ),
            {
                "x": 10,
                "y": 20,
                "radiusx": 30,
                "radiusy": 40,
                "rotation": 0.0,
                "startangle": 0.0,
                "endangle": pytest.approx(6.283185),
                "anticlockwise": False,

=====================================================================
Found a 9 line (38 tokens) duplication in the following files: 
Starting at line 299 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 593 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    other = ExampleWidget(id="other")
    child = ExampleLeafWidget(id="child_id")
    other.add(child)

    assert other.children == [child]
    assert child.parent == other

    # Add the child to the widget
    widget.add(child)

=====================================================================
Found a 8 line (38 tokens) duplication in the following files: 
Starting at line 25 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_button.py
Starting at line 50 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_switch.py

TEST_TEXT_VALUES = [
    ("New Text", "New Text"),
    ("", ""),
    (None, ""),
    ("\u200B", ""),
    (12345, "12345"),
    ("Contains\nnewline", "Contains"),
]

=====================================================================
Found a 10 line (38 tokens) duplication in the following files: 
Starting at line 61 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 120 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 195 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 264 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py

@pytest.mark.parametrize(
    "value, expected",
    [
        # float
        (1.23, Decimal("1.23")),
        (1.23e4, Decimal("12300")),
        # Integer
        (123, Decimal("123")),
        # Float and integer specified as string
        ("1.23", Decimal("1.23")),

=====================================================================
Found a 14 line (38 tokens) duplication in the following files: 
Starting at line 88 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_numberinput.py
Starting at line 95 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_textinput.py

    EventLog.reset()

    # Define and set a new change callback
    on_change_handler = Mock()
    widget.on_change = on_change_handler

    widget.value = value
    assert widget.value == expected

    # test backend has the right value
    assert attribute_value(widget, "value") == expected

    # A refresh was performed
    assert_action_performed(widget, "refresh")

=====================================================================
Found a 10 line (38 tokens) duplication in the following files: 
Starting at line 16 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_selection.py
Starting at line 20 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

def on_change_handler():
    return Mock()


@pytest.fixture
def source():
    return ListSource(
        accessors=["key", "value"],
        data=[
            {"key": "first", "value": 111},

=====================================================================
Found a 10 line (38 tokens) duplication in the following files: 
Starting at line 70 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 120 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 189 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 226 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py
Starting at line 262 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_splitcontainer.py

@pytest.mark.parametrize(
    "include_left, include_right",
    [
        (False, False),
        (False, True),
        (True, False),
        (True, True),
    ],
)
def test_assign_to_app(app, content1, content2, include_left, include_right):

=====================================================================
Found a 7 line (38 tokens) duplication in the following files: 
Starting at line 59 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 28 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py

    assert window.position == (150, 150)
    assert window.size == (640, 480)
    assert window.resizable
    assert window.closable
    assert window.minimizable
    # Default on-close handler is to confirm close.
    assert window.on_close._raw == window._confirm_close

=====================================================================
Found a 13 line (38 tokens) duplication in the following files: 
Starting at line 132 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 182 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py

    window._impl.simulate_close()

    # Window has been closed, and is no longer in the app's list of windows.
    assert window.closed
    assert window.app == app
    assert window not in app.windows
    assert_action_performed(window, "close")

    # No save attempt was made.
    doc._mock_write.assert_not_called()


def test_close_modified(app):

=====================================================================
Found a 8 line (37 tokens) duplication in the following files: 
Starting at line 33 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 124 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    probe.assert_image_size(144, 72)

    # Clear the image; it's now an explicit sized empty image.
    widget.image = None

    await probe.redraw("Image has been cleared")
    assert probe.width == pytest.approx(0, abs=2)
    assert probe.height == pytest.approx(0, abs=2)

=====================================================================
Found a 8 line (37 tokens) duplication in the following files: 
Starting at line 82 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 168 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    probe.assert_image_size(200, 100)

    # Clear the image; it's now an explicit sized empty image.
    widget.image = None

    await probe.redraw("Image has been cleared")
    assert probe.width == pytest.approx(200, abs=2)
    assert probe.height == pytest.approx(0, abs=2)

=====================================================================
Found a 3 line (37 tokens) duplication in the following files: 
Starting at line 240 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 250 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 260 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 270 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 280 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 290 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 450 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])
    assert not probe.is_expanded(source[2][2])

=====================================================================
Found a 11 line (37 tokens) duplication in the following files: 
Starting at line 152 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py
Starting at line 152 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py

    assert app._impl.loop.run_until_complete(app.dialog(dialog)) is saved_file

    assert_action_performed_with(
        dialog,
        "create SaveFileDialog",
        title="Title",
        filename="initial_file.txt",
        initial_directory=None,
        file_types=[".txt", ".pdf"],
    )
    assert_action_performed_with(

=====================================================================
Found a 11 line (37 tokens) duplication in the following files: 
Starting at line 207 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py
Starting at line 207 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py

    assert app._impl.loop.run_until_complete(app.dialog(dialog)) is opened_files

    assert_action_performed_with(
        dialog,
        "create OpenFileDialog",
        title="Title",
        initial_directory=None,
        file_types=[".txt", ".pdf"],
        multiple_select=True,
    )
    assert_action_performed_with(

=====================================================================
Found a 7 line (37 tokens) duplication in the following files: 
Starting at line 579 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 610 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 644 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 710 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    new_doc = doc_app.documents[-1]
    assert new_doc.path == other_file
    assert new_doc.main_window.doc == new_doc
    assert new_doc.main_window in doc_app.windows

    # New window is in the same position as the old one.
    assert new_doc.main_window.position == orig_position

=====================================================================
Found a 13 line (37 tokens) duplication in the following files: 
Starting at line 177 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 195 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py
Starting at line 213 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_list_source.py

        MyObject("string"),
    ]

    source = ListSource(
        data=data,
        accessors=["col1"],
    )

    for i, row in enumerate(source):
        assert row.col1 == data[i]


def test_flat_list_numbers():

=====================================================================
Found a 9 line (37 tokens) duplication in the following files: 
Starting at line 14 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_tutorial0.py
Starting at line 49 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_tutorial1.py

                "button", style=Pack(flex=1, padding=50), size=(at_least(120), 30)
            ),
        ],
    )

    root.style.layout(root, ExampleViewport(640, 480))
    assert_layout(
        root,
        (220, 130),

=====================================================================
Found a 5 line (37 tokens) duplication in the following files: 
Starting at line 450 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 492 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 528 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 565 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 581 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 617 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 643 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

    assert widget._impl.draw_instructions == [
        ("push context", {}),
        ("line to", {"x": 0, "y": 0}),
        ("push context", {}),
        ("line to", {"x": 10, "y": 20}),

=====================================================================
Found a 11 line (37 tokens) duplication in the following files: 
Starting at line 687 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 720 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 753 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py
Starting at line 787 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_context_objects.py

                "fill_color": rgb(255, 0, 0),
                "fill_rule": FillRule.NONZERO,
                "stroke_color": rgb(0, 255, 0),
                "line_width": 2.0,
                "line_dash": None,
            },
        ),
        (
            "line to",
            {
                "x": 100,

=====================================================================
Found a 14 line (37 tokens) duplication in the following files: 
Starting at line 99 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 373 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py

        ("fill", draw_kwargs),
    ]

    # All the attributes can be retrieved.
    for attr, value in draw_kwargs.items():
        assert getattr(draw_op, attr) == value


@pytest.mark.parametrize(
    "kwargs, args_repr, draw_kwargs",
    [
        # Defaults
        (
            {},

=====================================================================
Found a 12 line (37 tokens) duplication in the following files: 
Starting at line 782 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 842 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    assert_action_performed_with(widget, "remove child", child=child1._impl)
    assert_action_performed_with(widget, "remove child", child=child3._impl)

    # The widget's layout has been refreshed
    assert_action_performed_with(widget, "refresh")

    # The window's content gets a refresh notification
    assert_action_performed_with(window.content, "refresh")

    # App's widget index does not contain the widget
    assert "child1_id" not in app.widgets
    assert "child3_id" not in app.widgets

=====================================================================
Found a 10 line (37 tokens) duplication in the following files: 
Starting at line 170 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_mapview.py
Starting at line 213 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_mapview.py

    assert pin.title == "On map"
    assert_action_performed_with(widget, "update pin", pin=pin)

    # Remove the pin from the map
    EventLog.reset()
    widget.pins.remove(pin)
    assert_action_performed_with(widget, "remove pin", pin=pin)

    # Updating the title doesn't modify the map
    pin.title = "Off map"

=====================================================================
Found a 6 line (37 tokens) duplication in the following files: 
Starting at line 451 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py
Starting at line 506 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py

    impl.set_min(0)
    impl.set_max(0)
    impl.set_value(0)
    assert impl.get_value() == 0
    assert impl.int_value == 0
    assert impl.int_max == 10000

=====================================================================
Found a 6 line (37 tokens) duplication in the following files: 
Starting at line 459 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py
Starting at line 514 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_slider.py

    impl.set_min(1)
    impl.set_max(1)
    impl.set_value(1)
    assert impl.get_value() == 1
    assert impl.int_value == 0
    assert impl.int_max == 10000

=====================================================================
Found a 10 line (37 tokens) duplication in the following files: 
Starting at line 64 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py
Starting at line 96 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py

    table = toga.Table(
        ["First", "Second"],
        data=source,
        accessors=["primus", "secondus"],
        multiple_select=True,
        on_select=on_select_handler,
        on_activate=on_activate_handler,
        missing_value="Boo!",
    )
    assert table._impl.interface == table

=====================================================================
Found a 8 line (37 tokens) duplication in the following files: 
Starting at line 69 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 38 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py

    assert len(window.toolbar) == 0
    assert window.toolbar.on_change is not None


def test_create_explicit(app):
    """Explicit arguments at construction are stored."""
    on_close_handler = Mock()
    window_content = toga.Box()

=====================================================================
Found a 13 line (37 tokens) duplication in the following files: 
Starting at line 154 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 205 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py

    window._impl.dialog_responses["QuestionDialog"] = [True]

    # Trigger a window close
    window._impl.simulate_close()

    # Window has been closed, and is no longer in the app's list of windows.
    assert window.closed
    assert window.app == app
    assert window not in app.windows
    assert_action_performed(window, "close")

    # A save attempt was made.
    doc._mock_write.assert_called_once_with(mock_path)

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 404 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py
Starting at line 475 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_desktop.py

    on_exit_handler = Mock(return_value=True)
    monkeypatch.setattr(app, "on_exit", on_exit_handler)

    # Create and show a secondary window
    secondary_window = toga.Window()
    secondary_window.show()

    try:
        # Change the app to a session-based app
        app.main_window = None

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 38 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 83 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py
Starting at line 97 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_document_app.py

    await app_probe.redraw("Document has been opened", delay=0.1)

    assert len(app.documents) == 1
    assert len(app.windows) == 2

    # Document has been read.
    app.documents[0]._content.read.assert_called_with(document_path)


async def test_open_missing_document(app, app_probe):

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 36 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/conftest.py
Starting at line 18 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/conftest.py

@fixture(autouse=True)
def no_dangling_tasks():
    """Ensure any tasks for the test were removed when the test finished."""
    yield
    if toga.App.app:
        tasks = toga.App.app._running_tasks
        assert not tasks, f"the app has dangling tasks: {tasks}"


@fixture(scope="session")

=====================================================================
Found a 15 line (36 tokens) duplication in the following files: 
Starting at line 24 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_detailedlist.py
Starting at line 21 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_detailedlist.py

    return Mock()


@pytest.fixture
def on_primary_action_handler():
    return Mock()


@pytest.fixture
def on_secondary_action_handler():
    return Mock()


@pytest.fixture
def source():

=====================================================================
Found a 13 line (36 tokens) duplication in the following files: 
Starting at line 108 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_detailedlist.py
Starting at line 144 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py

        assert not probe.refresh_available()

    # Row 50 should be visible. It could be at the top of the screen, or the bottom of
    # the screen; we don't really care which - as long as it's roughly in the middle of
    # the scroll range, call it a win.
    assert probe.scroll_position == pytest.approx(
        probe.max_scroll_position / 2, abs=400
    )

    # Scroll to the top of the detailedList
    widget.scroll_to_top()
    await probe.wait_for_scroll_completion()
    await probe.redraw("DetailedList scrolled to bottom")

=====================================================================
Found a 4 line (36 tokens) duplication in the following files: 
Starting at line 163 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 173 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 183 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py
Starting at line 193 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_imageview.py

    await probe.redraw("Image has explicit sizing")
    assert probe.width == pytest.approx(200, abs=2)
    assert probe.height == pytest.approx(300, abs=2)
    assert not probe.preserve_aspect_ratio

=====================================================================
Found a 7 line (36 tokens) duplication in the following files: 
Starting at line 325 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py
Starting at line 347 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_optioncontainer.py

        probe.assert_tab_icon(probe.max_tabs - 1, None)
        assert widget.content[probe.max_tabs - 1].enabled

        # As the item is visible, also verify the actual widget properties
        probe.assert_tab_content(
            probe.max_tabs - 1,
            f"Tab {probe.max_tabs - 1}",

=====================================================================
Found a 13 line (36 tokens) duplication in the following files: 
Starting at line 29 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 14 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

@pytest.fixture
def on_select_handler():
    return Mock()


@pytest.fixture
def on_activate_handler():
    return Mock()


@pytest.fixture
def source():
    return TreeSource(

=====================================================================
Found a 4 line (36 tokens) duplication in the following files: 
Starting at line 238 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 248 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 258 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 268 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 278 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 288 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 318 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 328 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 398 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 408 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 418 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 428 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0][2])
    assert probe.is_expanded(source[1])
    assert probe.is_expanded(source[1][2])
    assert not probe.is_expanded(source[2])

=====================================================================
Found a 7 line (36 tokens) duplication in the following files: 
Starting at line 349 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 359 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 410 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 420 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[1])
    # State of source[1][2] is ambiguous
    assert probe.is_expanded(source[2])
    assert probe.is_expanded(source[2][2])

    # Collapse a single child node
    widget.collapse(source[0][2])

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 365 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py
Starting at line 453 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py
Starting at line 510 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py
Starting at line 560 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/window/test_window.py

    @pytest.mark.parametrize(
        "second_window_class, second_window_kwargs",
        [
            (
                toga.Window,
                dict(title="Secondary Window", position=(200, 150)),
            )
        ],
    )
    async def test_visibility(app, second_window, second_window_probe):

=====================================================================
Found a 11 line (36 tokens) duplication in the following files: 
Starting at line 124 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py
Starting at line 124 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py

    assert app._impl.loop.run_until_complete(app.dialog(dialog)) is saved_file

    assert_action_performed_with(
        dialog,
        "create SaveFileDialog",
        title="Title",
        filename="initial_file.txt",
        initial_directory=Path("/path/to"),
        file_types=None,
    )
    assert_action_performed_with(

=====================================================================
Found a 11 line (36 tokens) duplication in the following files: 
Starting at line 176 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py
Starting at line 176 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py

    assert app._impl.loop.run_until_complete(app.dialog(dialog)) is opened_file

    assert_action_performed_with(
        dialog,
        "create OpenFileDialog",
        title="Title",
        initial_directory=Path("/path/to/folder"),
        file_types=None,
        multiple_select=False,
    )
    assert_action_performed_with(

=====================================================================
Found a 9 line (36 tokens) duplication in the following files: 
Starting at line 86 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 410 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 450 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    monkeypatch.setattr(sys, "argv", ["app-exe", str(example_file)])
    app = ExampleDocumentApp(
        "Test App",
        "org.beeware.document-app",
        document_types=[ExampleDocument, OtherDocument],
    )
    # The app will have a single window; set this window as the current window
    # so that dialogs have something to hang off.
    app.current_window = list(app.windows)[0]

=====================================================================
Found a 9 line (36 tokens) duplication in the following files: 
Starting at line 864 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 890 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    second_doc.main_window._impl.dialog_responses["SaveFileDialog"] = [path]

    # Activate the save menu
    future = doc_app.commands[toga.Command.SAVE].action()
    doc_app.loop.run_until_complete(future)

    # The second document is the one we saved
    first_doc._mock_write.assert_not_called()
    second_doc._mock_write.assert_called_once_with(path)

=====================================================================
Found a 9 line (36 tokens) duplication in the following files: 
Starting at line 903 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 1018 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 1040 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    current_window = doc_app.current_window
    first_doc = current_window.doc
    assert first_doc.path == example_file

    # Open a second new document
    second_doc = doc_app.documents.new(ExampleDocument)

    # Open a non-document window, and make it current
    third_window = toga.Window(title="Not a document")

=====================================================================
Found a 9 line (36 tokens) duplication in the following files: 
Starting at line 980 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 1005 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    second_doc.main_window._impl.dialog_responses["SaveFileDialog"] = [path]

    # Activate the Save As menu
    future = doc_app.commands[toga.Command.SAVE_AS].action()
    doc_app.loop.run_until_complete(future)

    # The second document is the one we saved
    first_doc._mock_write.assert_not_called()
    second_doc._mock_write.assert_called_once_with(path)

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 24 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_menustatusicon.py
Starting at line 20 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_simplestatusicon.py

    assert repr(status_icon).startswith("<MenuStatusIcon 'Test App': menustatusitem-")

    # Status icon wasn't created as a result of being instantiated
    assert_action_not_performed(status_icon, "create")
    # ... but an icon was set.
    assert_action_performed(status_icon, "set icon")


@pytest.mark.parametrize("construct_icon", [True, False])
def test_create_with_params(app, construct_icon):

=====================================================================
Found a 9 line (36 tokens) duplication in the following files: 
Starting at line 65 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 150 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        return 42

    wrapped = wrapped_handler(obj, handler)

=====================================================================
Found a 7 line (36 tokens) duplication in the following files: 
Starting at line 120 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 252 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    cleanup = Mock()
    handler_call = {}

    def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 327 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_canvas.py
Starting at line 350 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_canvas.py

        ("close path", {}),
        ("pop context", {}),
        # Fill
        ("push context", {}),
        ("begin path", {}),
        (
            "line to",
            {
                "x": 20,
                "y": 30,

=====================================================================
Found a 8 line (36 tokens) duplication in the following files: 
Starting at line 397 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 415 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 433 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py
Starting at line 469 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/canvas/test_draw_operations.py

                "startangle": 0.0,
                "endangle": pytest.approx(6.283185),
                "anticlockwise": False,
            },
        ),
        # Rotation
        (
            {"x": 10, "y": 20, "radiusx": 30, "radiusy": 40, "rotation": 1.234},

=====================================================================
Found a 11 line (36 tokens) duplication in the following files: 
Starting at line 228 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 405 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 460 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 535 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    window = toga.Window()
    window.content = widget
    # Clear the event log
    EventLog.reset()

    # Widget has an app and window
    assert widget.app == app
    assert widget.window == window

    # Child list is empty
    assert widget.children == []

=====================================================================
Found a 7 line (36 tokens) duplication in the following files: 
Starting at line 1119 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 1144 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    window = toga.Window()
    assert len(window.widgets) == 0
    assert widget.window is None

    # Assign the widget to a window
    widget.window = window
    assert len(window.widgets) == 1

=====================================================================
Found a 17 line (36 tokens) duplication in the following files: 
Starting at line 110 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_dateinput.py
Starting at line 104 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_timeinput.py

    widget.max = date(2020, 1, 1)
    on_change_handler.reset_mock()

    # Set the new value
    widget.value = value

    # Value has been clipped
    assert widget.value == clipped

    # on_change handler called once.
    on_change_handler.assert_called_once_with(widget)


@pytest.mark.parametrize(
    "value, expected",
    [
        (None, date(1800, 1, 1)),

=====================================================================
Found a 18 line (36 tokens) duplication in the following files: 
Starting at line 171 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_detailedlist.py
Starting at line 169 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_table.py

                {"key": "Charlie", "value": 345, "icon": "icon3", "extra": "extra3"},
            ],
            True,
            True,
        ),
        # List of bare data
        (
            [
                "Alice",
                1234,
                "Charlie",
            ],
            False,
            False,
        ),
    ],
)
def test_set_data(

=====================================================================
Found a 8 line (36 tokens) duplication in the following files: 
Starting at line 85 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_imageview.py
Starting at line 96 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_imageview.py

    assert_action_performed_with(widget, "set image", image=ANY)
    assert_action_performed(widget, "refresh")

    assert isinstance(widget.image, toga.Image)
    assert widget.image.path == ABSOLUTE_FILE_PATH


def test_set_image_path(widget):

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 317 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py
Starting at line 609 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py

@pytest.mark.parametrize("bare_item", [True, False])
@pytest.mark.parametrize(
    "value, expected",
    [
        ("New Title", "New Title"),
        (42, "42"),  # Evaluated as a string
        (MyTitle("Custom Title"), "Custom Title"),  # Evaluated as a string
    ],
)
def test_item_text(optioncontainer, value, expected, bare_item):

=====================================================================
Found a 10 line (36 tokens) duplication in the following files: 
Starting at line 338 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py
Starting at line 640 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py

@pytest.mark.parametrize("bare_item", [True, False])
@pytest.mark.parametrize(
    "value, error",
    [
        (None, r"Item text cannot be None"),
        ("", r"Item text cannot be blank"),
        (MyTitle(""), r"Item text cannot be blank"),
    ],
)
def test_invalid_item_text(optioncontainer, value, error, bare_item):

=====================================================================
Found a 13 line (36 tokens) duplication in the following files: 
Starting at line 569 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py
Starting at line 631 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py

        text="New Tab",
        widget=new_content._impl,
    )
    assert_action_performed_with(
        optioncontainer,
        "set option enabled",
        index=1,
        value=True,
    )
    assert_action_performed_with(optioncontainer, "refresh")


@pytest.mark.parametrize(

=====================================================================
Found a 2 line (36 tokens) duplication in the following files: 
Starting at line 192 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py
Starting at line 208 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

        assert win.position[0] > windows[-1].position[0]
        assert win.position[1] > windows[-1].position[1]

=====================================================================
Found a 9 line (35 tokens) duplication in the following files: 
Starting at line 140 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_app.py
Starting at line 207 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/app/test_app.py

    )
    app_probe.assert_menu_item(
        ["Other", "Submenu1", "Disabled"],
        enabled=False,
    )
    app_probe.assert_menu_item(
        ["Other", "Submenu1", "No Action"],
        enabled=False,
    )

=====================================================================
Found a 6 line (35 tokens) duplication in the following files: 
Starting at line 220 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/properties.py
Starting at line 235 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/properties.py

    widget.focus()
    await probe.redraw("Widget has focus; value is set")
    assert widget.value == "example"
    assert widget.placeholder == "replacement"
    assert probe.value == "example"
    assert not probe.placeholder_visible

=====================================================================
Found a 9 line (35 tokens) duplication in the following files: 
Starting at line 128 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_detailedlist.py
Starting at line 162 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 180 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

async def test_select(widget, probe, source, on_select_handler):
    """Rows can be selected"""
    # Initial selection is empty
    assert widget.selection is None
    await probe.redraw("No row is selected")
    on_select_handler.assert_not_called()

    # A single row can be selected
    await probe.select_row(1)

=====================================================================
Found a 12 line (35 tokens) duplication in the following files: 
Starting at line 29 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 29 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 14 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_tree.py

@pytest.fixture
def on_select_handler():
    return Mock()


@pytest.fixture
def on_activate_handler():
    return Mock()


@pytest.fixture
def source():

=====================================================================
Found a 10 line (35 tokens) duplication in the following files: 
Starting at line 263 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_table.py
Starting at line 527 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

class MyData:
    def __init__(self, text):
        self.text = text

    def __str__(self):
        return f"<data {self.text}>"


async def _row_change_test(widget, probe):
    """Meta test for adding and removing data to the table"""

=====================================================================
Found a 4 line (35 tokens) duplication in the following files: 
Starting at line 226 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 297 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 307 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 357 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 367 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 437 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py
Starting at line 447 of /home/vestel/pmd-bin-7.0.0/Toga/toga/testbed/tests/widgets/test_tree.py

    assert not probe.is_expanded(source[0])
    assert not probe.is_expanded(source[0][2])
    assert not probe.is_expanded(source[1])
    assert not probe.is_expanded(source[1][2])

=====================================================================
Found a 10 line (35 tokens) duplication in the following files: 
Starting at line 122 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py
Starting at line 150 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_dialogs.py

    dialog = toga.SaveFileDialog("Title", Path("/path/to/initial_file.txt"))

    assert app._impl.loop.run_until_complete(app.dialog(dialog)) is saved_file

    assert_action_performed_with(
        dialog,
        "create SaveFileDialog",
        title="Title",
        filename="initial_file.txt",
        initial_directory=Path("/path/to"),

=====================================================================
Found a 7 line (35 tokens) duplication in the following files: 
Starting at line 149 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 251 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 366 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 402 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    assert toga.Command.OPEN in app.commands
    assert toga.Command.SAVE in app.commands
    assert toga.Command.SAVE_AS in app.commands
    assert toga.Command.SAVE_ALL in app.commands


def test_create_no_cmdline_default_handling_close_on_last_window(monkeypatch):

=====================================================================
Found a 6 line (35 tokens) duplication in the following files: 
Starting at line 867 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 915 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    future = doc_app.commands[toga.Command.SAVE].action()
    doc_app.loop.run_until_complete(future)

    # The second document is the one we saved
    first_doc._mock_write.assert_not_called()
    second_doc._mock_write.assert_called_once_with(path)

=====================================================================
Found a 6 line (35 tokens) duplication in the following files: 
Starting at line 983 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py
Starting at line 1030 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/app/test_document_app.py

    future = doc_app.commands[toga.Command.SAVE_AS].action()
    doc_app.loop.run_until_complete(future)

    # The second document is the one we saved
    first_doc._mock_write.assert_not_called()
    second_doc._mock_write.assert_called_once_with(path)

=====================================================================
Found a 5 line (35 tokens) duplication in the following files: 
Starting at line 68 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py
Starting at line 140 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/command/test_commandset.py

    assert list(app.commands) == [cmd_a, cmd_b]


@pytest.mark.parametrize("change_handler", [(None), (Mock())])
def test_add_clear_with_app(app, change_handler):

=====================================================================
Found a 9 line (35 tokens) duplication in the following files: 
Starting at line 278 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 293 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 359 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 468 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py
Starting at line 519 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_tree_source.py

        {"val1": "new"},
        children=[
            ({"val1": "new child 1"}, None),
            ({"val1": "new child 2"}, None),
        ],
    )

    # Node has one more child.
    assert len(node) == 3

=====================================================================
Found a 9 line (35 tokens) duplication in the following files: 
Starting at line 336 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py
Starting at line 364 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/sources/test_node.py

    new_child = node.append({"val1": "new"})

    # Node has one more child.
    assert len(node) == 3
    assert node[2] == new_child

    # A child node was created using the source's factory
    source._create_node.assert_called_with(
        parent=node, data={"val1": "new"}, children=None

=====================================================================
Found a 6 line (35 tokens) duplication in the following files: 
Starting at line 77 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 117 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py
Starting at line 252 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/statusicons/test_statusiconset.py

    status_1 = SimpleStatusIcon(id="s1")
    status_2 = SimpleStatusIcon(id="s2")
    status_3 = SimpleStatusIcon(id="s3")
    statusiconset.add(status_1, status_2, status_3)

    assert len(statusiconset) == 3

=====================================================================
Found a 10 line (35 tokens) duplication in the following files: 
Starting at line 74 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py
Starting at line 193 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/style/pack/layout/test_fixed.py

        style=Pack(direction=ROW),
        children=[
            ExampleNode(
                "first",
                style=Pack(),
                size=(100, 100),
            ),
            ExampleNode(
                "second",
                style=Pack(direction=ROW),

=====================================================================
Found a 8 line (35 tokens) duplication in the following files: 
Starting at line 192 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_documents.py
Starting at line 236 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_documents.py

    doc.save(converter(path))

    # Calling absolute() ensures the expected value is correct on Windows
    assert doc.path == path.absolute()
    assert doc.title == "My Document: doc"
    assert doc._mock_content.write(path.absolute())
    # Saving clears the modification flag
    assert not doc.modified

=====================================================================
Found a 8 line (35 tokens) duplication in the following files: 
Starting at line 196 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 226 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 342 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 371 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    wrapped = wrapped_handler(obj, handler)

    # Raw handler is the original generator
    assert wrapped._raw == handler

    # Invoke the handler, and run until it is complete.
    assert (
        event_loop.run_until_complete(wrapped("arg1", "arg2", kwarg1=3, kwarg2=4)) == 42

=====================================================================
Found a 7 line (35 tokens) duplication in the following files: 
Starting at line 362 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 432 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    obj = Mock()
    handler_call = {}

    async def handler(*args, **kwargs):
        handler_call["args"] = args
        handler_call["kwargs"] = kwargs
        await asyncio.sleep(0.01)  # A short sleep

=====================================================================
Found a 10 line (35 tokens) duplication in the following files: 
Starting at line 568 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 704 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    result = ExampleAsyncResult()

    # Cancel the future
    result.future.cancel()

    result.set_exception(ValueError("Bad stuff"))

    # Evaluate the future. This will raise an error
    with pytest.raises(asyncio.CancelledError):
        event_loop.run_until_complete(result.future)

=====================================================================
Found a 11 line (35 tokens) duplication in the following files: 
Starting at line 593 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py
Starting at line 616 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_handlers.py

    assert wrapped("obj") == 42
    assert wrapped._raw == handler

    # The "widget" bound argument has been dropped
    assert handler_call == {
        "args": ("arg1", "arg2"),
        "kwargs": {"kwarg1": 3, "kwarg2": 4},
    }


def test_simple_handler_coroutine(event_loop):

=====================================================================
Found a 12 line (35 tokens) duplication in the following files: 
Starting at line 153 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_validators.py
Starting at line 245 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/test_validators.py

            "Input should start with 'hello'",
        ),
        # Custom error message
        (
            "bad string",
            dict(substring="hello", error_message="Badness"),
            "Badness",
        ),
        # Don't allow empty strings
        (
            "",
            dict(substring="hello", allow_empty=False),

=====================================================================
Found a 11 line (35 tokens) duplication in the following files: 
Starting at line 329 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py
Starting at line 623 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_base.py

    child = ExampleLeafWidget(id="child_id")
    widget.add(child)

    assert widget.children == [child]
    assert child.parent == widget

    # Reset the event log so all previous add events are lost
    EventLog.reset()

    # Add the child to the widget again
    widget.add(child)

=====================================================================
Found a 9 line (35 tokens) duplication in the following files: 
Starting at line 132 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_mapview.py
Starting at line 171 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_mapview.py
Starting at line 214 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_mapview.py

    assert_action_performed_with(widget, "update pin", pin=pin)

    # Remove the pin from the map
    EventLog.reset()
    widget.pins.remove(pin)
    assert_action_performed_with(widget, "remove pin", pin=pin)

    # Updating the location doesn't modify the map
    pin.location = toga.LatLng(12.34, 56.78)

=====================================================================
Found a 15 line (35 tokens) duplication in the following files: 
Starting at line 7 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_optioncontainer.py
Starting at line 7 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/widgets/test_scrollcontainer.py

from toga_dummy.utils import (
    EventLog,
    assert_action_not_performed,
    assert_action_performed,
    assert_action_performed_with,
)


@pytest.fixture
def window():
    return toga.Window()


@pytest.fixture
def content1():

=====================================================================
Found a 10 line (35 tokens) duplication in the following files: 
Starting at line 122 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py
Starting at line 150 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_dialogs.py

    dialog = toga.SaveFileDialog("Title", Path("/path/to/initial_file.txt"))

    assert app._impl.loop.run_until_complete(window.dialog(dialog)) is saved_file

    assert_action_performed_with(
        dialog,
        "create SaveFileDialog",
        title="Title",
        filename="initial_file.txt",
        initial_directory=Path("/path/to"),

=====================================================================
Found a 13 line (35 tokens) duplication in the following files: 
Starting at line 154 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 179 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py
Starting at line 205 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_document_window.py

    window._impl.dialog_responses["QuestionDialog"] = [True]

    # Trigger a window close
    window._impl.simulate_close()

    # Window has been closed, and is no longer in the app's list of windows.
    assert window.closed
    assert window.app == app
    assert window not in app.windows
    assert_action_performed(window, "close")

    # A save attempt was made.
    doc._mock_write.assert_called_once_with(mock_path)

=====================================================================
Found a 6 line (35 tokens) duplication in the following files: 
Starting at line 186 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py
Starting at line 215 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

        win_1.content.add(second)

    assert "magic" in app.widgets
    assert "magic" in win_1.widgets
    assert "magic" not in win_2.widgets
    assert app.widgets["magic"] == first

=====================================================================
Found a 6 line (35 tokens) duplication in the following files: 
Starting at line 186 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py
Starting at line 198 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_filtered_widget_registry.py

        win_1.content.add(second)

    assert "magic" in app.widgets
    assert "magic" in win_1.widgets
    assert "magic" not in win_2.widgets
    assert app.widgets["magic"] == first

=====================================================================
Found a 6 line (35 tokens) duplication in the following files: 
Starting at line 47 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_main_window.py
Starting at line 42 of /home/vestel/pmd-bin-7.0.0/Toga/toga/tests/window/test_window.py

    window = toga.MainWindow(
        id="my-window",
        title="My Window",
        position=toga.Position(10, 20),
        size=toga.Position(200, 300),
        resizable=False,

